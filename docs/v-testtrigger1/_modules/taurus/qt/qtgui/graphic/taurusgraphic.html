

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>taurus.qt.qtgui.graphic.taurusgraphic &mdash; taurus 4.1.2-alpha documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../../../search.html"/>
    <link rel="top" title="taurus 4.1.2-alpha documentation" href="../../../../../index.html"/>
        <link rel="up" title="Module code" href="../../../../index.html"/> 

  
  <script src="../../../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../../../index.html" class="icon icon-home"> taurus
          

          
            
            <img src="../../../../../_static/taurus.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                4.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference external" href="http://www.taurus-scada.org">Home Page</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/taurus-org/taurus">Project Page</a></li>
<li class="toctree-l1"><a class="reference external" href="http://pypi.python.org/pypi/taurus">Download from PyPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../docs.html">Taurus 4.1 documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../../../index.html">taurus</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../../../../index.html">Module code</a> &raquo;</li>
      
    <li>taurus.qt.qtgui.graphic.taurusgraphic</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for taurus.qt.qtgui.graphic.taurusgraphic</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>

<span class="c1">#############################################################################</span>
<span class="c1">##</span>
<span class="c1"># This file is part of Taurus</span>
<span class="c1">##</span>
<span class="c1"># http://taurus-scada.org</span>
<span class="c1">##</span>
<span class="c1"># Copyright 2011 CELLS / ALBA Synchrotron, Bellaterra, Spain</span>
<span class="c1">##</span>
<span class="c1"># Taurus is free software: you can redistribute it and/or modify</span>
<span class="c1"># it under the terms of the GNU Lesser General Public License as published by</span>
<span class="c1"># the Free Software Foundation, either version 3 of the License, or</span>
<span class="c1"># (at your option) any later version.</span>
<span class="c1">##</span>
<span class="c1"># Taurus is distributed in the hope that it will be useful,</span>
<span class="c1"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1"># GNU Lesser General Public License for more details.</span>
<span class="c1">##</span>
<span class="c1"># You should have received a copy of the GNU Lesser General Public License</span>
<span class="c1"># along with Taurus.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<span class="c1">##</span>
<span class="c1">#############################################################################</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">taurusgraphic.py:</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SynopticSelectionStyle&#39;</span><span class="p">,</span>
           <span class="s1">&#39;parseTangoUri&#39;</span><span class="p">,</span>
           <span class="s1">&#39;QEmitter&#39;</span><span class="p">,</span>  <span class="c1"># TODO: QEmitter should probably be removed (kept priv)</span>
           <span class="s1">&#39;TaurusGraphicsUpdateThread&#39;</span><span class="p">,</span>
           <span class="s1">&#39;TaurusGraphicsScene&#39;</span><span class="p">,</span>
           <span class="s1">&#39;QGraphicsTextBoxing&#39;</span><span class="p">,</span>
           <span class="s1">&#39;QSpline&#39;</span><span class="p">,</span>
           <span class="s1">&#39;TaurusGraphicsItem&#39;</span><span class="p">,</span>
           <span class="s1">&#39;TaurusGraphicsAttributeItem&#39;</span><span class="p">,</span>
           <span class="s1">&#39;TaurusGraphicsStateItem&#39;</span><span class="p">,</span>
           <span class="s1">&#39;TaurusEllipseStateItem&#39;</span><span class="p">,</span>
           <span class="s1">&#39;TaurusRectStateItem&#39;</span><span class="p">,</span>
           <span class="s1">&#39;TaurusSplineStateItem&#39;</span><span class="p">,</span>
           <span class="s1">&#39;TaurusRoundRectItem&#39;</span><span class="p">,</span>
           <span class="s1">&#39;TaurusRoundRectStateItem&#39;</span><span class="p">,</span>
           <span class="s1">&#39;TaurusGroupItem&#39;</span><span class="p">,</span>
           <span class="s1">&#39;TaurusGroupStateItem&#39;</span><span class="p">,</span>
           <span class="s1">&#39;TaurusPolygonStateItem&#39;</span><span class="p">,</span>
           <span class="s1">&#39;TaurusLineStateItem&#39;</span><span class="p">,</span>
           <span class="s1">&#39;TaurusTextStateItem&#39;</span><span class="p">,</span>
           <span class="s1">&#39;TaurusTextAttributeItem&#39;</span><span class="p">,</span>
           <span class="s1">&#39;TYPE_TO_GRAPHICS&#39;</span><span class="p">,</span>
           <span class="s1">&#39;TaurusBaseGraphicsFactory&#39;</span><span class="p">,</span>
           <span class="p">]</span>

<span class="n">__docformat__</span> <span class="o">=</span> <span class="s1">&#39;restructuredtext&#39;</span>

<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">traceback</span>
<span class="kn">import</span> <span class="nn">operator</span>
<span class="kn">import</span> <span class="nn">types</span>

<span class="kn">import</span> <span class="nn">Queue</span>

<span class="kn">from</span> <span class="nn">taurus</span> <span class="k">import</span> <span class="n">Manager</span>
<span class="kn">from</span> <span class="nn">taurus.core</span> <span class="k">import</span> <span class="n">AttrQuality</span><span class="p">,</span> <span class="n">DataType</span>
<span class="kn">from</span> <span class="nn">taurus.core.util.containers</span> <span class="k">import</span> <span class="n">CaselessDefaultDict</span>
<span class="kn">from</span> <span class="nn">taurus.core.util.log</span> <span class="k">import</span> <span class="n">Logger</span><span class="p">,</span> <span class="n">deprecation_decorator</span>
<span class="kn">from</span> <span class="nn">taurus.core.taurusdevice</span> <span class="k">import</span> <span class="n">TaurusDevice</span>
<span class="kn">from</span> <span class="nn">taurus.core.taurusattribute</span> <span class="k">import</span> <span class="n">TaurusAttribute</span>
<span class="kn">from</span> <span class="nn">taurus.core.util.enumeration</span> <span class="k">import</span> <span class="n">Enumeration</span>
<span class="c1"># TODO: tango-centric!</span>
<span class="kn">from</span> <span class="nn">taurus.core.tango</span> <span class="k">import</span> <span class="n">DevState</span>
<span class="kn">from</span> <span class="nn">taurus.core.tango.tangovalidator</span> <span class="k">import</span> <span class="p">(</span><span class="n">TangoDeviceNameValidator</span><span class="p">,</span>
                                              <span class="n">TangoAttributeNameValidator</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">taurus.external.qt</span> <span class="k">import</span> <span class="n">Qt</span>
<span class="kn">from</span> <span class="nn">taurus.qt.qtgui.base</span> <span class="k">import</span> <span class="n">TaurusBaseComponent</span>
<span class="kn">from</span> <span class="nn">taurus.qt.qtgui.util</span> <span class="k">import</span> <span class="p">(</span><span class="n">QT_ATTRIBUTE_QUALITY_PALETTE</span><span class="p">,</span> <span class="n">QT_DEVICE_STATE_PALETTE</span><span class="p">,</span>
                                  <span class="n">ExternalAppAction</span><span class="p">,</span> <span class="n">TaurusWidgetFactory</span><span class="p">)</span>


<span class="n">SynopticSelectionStyle</span> <span class="o">=</span> <span class="n">Enumeration</span><span class="p">(</span><span class="s2">&quot;SynopticSelectionStyle&quot;</span><span class="p">,</span> <span class="p">[</span>
    <span class="c1"># A blue ellipse is displayed around the selected objects</span>
    <span class="s2">&quot;ELLIPSE&quot;</span><span class="p">,</span>
    <span class="c1"># The own outline of selected object is displayed in blue and bolder</span>
    <span class="s2">&quot;OUTLINE&quot;</span><span class="p">,</span>
<span class="p">])</span>


<div class="viewcode-block" id="parseTangoUri"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic.html#taurus.qt.qtgui.graphic.parseTangoUri">[docs]</a><span class="k">def</span> <span class="nf">parseTangoUri</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">taurus.core</span> <span class="k">import</span> <span class="n">tango</span>
    <span class="n">validator</span> <span class="o">=</span> <span class="p">{</span><span class="n">tango</span><span class="o">.</span><span class="n">TangoDevice</span><span class="p">:</span> <span class="n">TangoDeviceNameValidator</span><span class="p">,</span>
                 <span class="n">tango</span><span class="o">.</span><span class="n">TangoAttribute</span><span class="p">:</span> <span class="n">TangoAttributeNameValidator</span><span class="p">}</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">validator</span><span class="p">[</span><span class="n">tango</span><span class="o">.</span><span class="n">TangoFactory</span><span class="p">()</span><span class="o">.</span><span class="n">findObjectClass</span><span class="p">(</span><span class="n">name</span><span class="p">)]()</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">getUriGroups</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">params</span> <span class="k">if</span> <span class="s1">&#39;_devslashname&#39;</span> <span class="ow">in</span> <span class="n">params</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="QEmitter"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_QEmitter.html#taurus.qt.qtgui.graphic.QEmitter">[docs]</a><span class="k">class</span> <span class="nc">QEmitter</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">QObject</span><span class="p">):</span>
    <span class="n">updateView</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span></div>


<div class="viewcode-block" id="TaurusGraphicsUpdateThread"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsUpdateThread.html#taurus.qt.qtgui.graphic.TaurusGraphicsUpdateThread">[docs]</a><span class="k">class</span> <span class="nc">TaurusGraphicsUpdateThread</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">QThread</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parent most not be None and must be a TaurusGraphicsScene!&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">TaurusGraphicsScene</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Illegal parent for TaurusGraphicsUpdateThread&quot;</span><span class="p">)</span>
        <span class="n">Qt</span><span class="o">.</span><span class="n">QThread</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">period</span> <span class="o">=</span> <span class="n">period</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">Logger</span><span class="p">(</span><span class="s1">&#39;TaurusGraphicsUpdateThread&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_updateView</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="c1"># The first one is the prefered one because it improves performance</span>
        <span class="c1"># since updates don&#39;t come very often in comparison to with the refresh</span>
        <span class="c1"># rate of the monitor (~70Hz)</span>
        <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">viewportUpdateMode</span><span class="p">()</span> <span class="o">==</span> <span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsView</span><span class="o">.</span><span class="n">NoViewportUpdate</span><span class="p">:</span>
            <span class="c1"># We call the update to the viewport instead of the view</span>
            <span class="c1"># itself because apparently there is a bug in QT 4.3 that</span>
            <span class="c1"># prevents a proper update when the view is inside a QTab</span>
            <span class="n">v</span><span class="o">.</span><span class="n">viewport</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># @todo This is probably a bug (item_rects is not defined). But it is defined in .run(), see &quot;todo&quot; below...</span>
            <span class="n">v</span><span class="o">.</span><span class="n">updateScene</span><span class="p">(</span><span class="n">item_rects</span><span class="p">)</span>
            <span class="c1"># v.invalidateScene(item.boundingRect())</span>
        <span class="k">return</span>

<div class="viewcode-block" id="TaurusGraphicsUpdateThread.run"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsUpdateThread.html#taurus.qt.qtgui.graphic.TaurusGraphicsUpdateThread.run">[docs]</a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;run... - TaurusGraphicsUpdateThread&quot;</span><span class="p">)</span>
        <span class="n">emitter</span> <span class="o">=</span> <span class="n">QEmitter</span><span class="p">()</span>
        <span class="n">emitter</span><span class="o">.</span><span class="n">moveToThread</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span><span class="o">.</span><span class="n">thread</span><span class="p">())</span>
        <span class="n">emitter</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">instance</span><span class="p">())</span>
        <span class="n">emitter</span><span class="o">.</span><span class="n">updateView</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_updateView</span><span class="p">)</span>

        <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">getQueue</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="ow">in</span> <span class="n">types</span><span class="o">.</span><span class="n">StringTypes</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">item</span> <span class="o">==</span> <span class="s2">&quot;exit&quot;</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">continue</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">operator</span><span class="o">.</span><span class="n">isSequenceType</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
                <span class="n">item</span> <span class="o">=</span> <span class="p">(</span><span class="n">item</span><span class="p">,)</span>
            <span class="c1"># @todo: Unless the call to boundingRect() has a side effect, this line is useless..  probably related to todo in _updateView()</span>
            <span class="n">item_rects</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">item</span><span class="p">]</span>

            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">views</span><span class="p">():</span>
                <span class="c1"># p.debug(&quot;emit(&#39;updateView&#39;)&quot;)</span>
                <span class="c1"># emitter.updateView.emit(v)</span>
                <span class="n">emitter</span><span class="o">.</span><span class="n">updateView</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="c1"># This sleep is needed to reduce CPU usage of the application!</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">period</span><span class="p">)</span></div></div>
            <span class="c1"># End of while</span>
        <span class="c1"># End of Thread</span>


<div class="viewcode-block" id="TaurusGraphicsScene"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsScene.html#taurus.qt.qtgui.graphic.TaurusGraphicsScene">[docs]</a><span class="k">class</span> <span class="nc">TaurusGraphicsScene</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsScene</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This class encapsulates TaurusJDrawSynopticsView and TaurusGraphicsScene signals/slots</span>

<span class="sd">    External events::</span>

<span class="sd">     Slot selectGraphicItem(const QString &amp;) displays a selection</span>
<span class="sd">     mark around the TaurusGraphicsItem that matches the argument passed.</span>

<span class="sd">    Mouse Left-button events::</span>

<span class="sd">     Signal graphicItemSelected(QString) is triggered, passing the</span>
<span class="sd">     selected TaurusGraphicsItem.name() as argument.</span>

<span class="sd">    Mouse Right-button events::</span>

<span class="sd">     TaurusGraphicsItem.setContextMenu([(ActionName,ActionMethod(device_name))]</span>
<span class="sd">     allows to configure custom context menus for graphic items using a list</span>
<span class="sd">     of tuples. Empty tuples will insert separators in the menu.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">ANY_ATTRIBUTE_SELECTS_DEVICE</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">TRACE_ALL</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="n">refreshTree2</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">()</span>
    <span class="n">graphicItemSelected</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">(</span><span class="s1">&#39;QString&#39;</span><span class="p">)</span>
    <span class="n">graphicSceneClicked</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">(</span><span class="s1">&#39;QPoint&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">strt</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="c1"># self.call__init__(Logger, name, parent) #Inheriting from Logger</span>
        <span class="c1"># caused exceptions in CONNECT</span>
        <span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsScene</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateQueue</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateThread</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_itemnames</span> <span class="o">=</span> <span class="n">CaselessDefaultDict</span><span class="p">(</span><span class="k">lambda</span> <span class="n">k</span><span class="p">:</span> <span class="nb">set</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_selection</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_selectedItems</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_selectionStyle</span> <span class="o">=</span> <span class="n">SynopticSelectionStyle</span><span class="o">.</span><span class="n">OUTLINE</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">threads</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pids</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">panels</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">panel_launcher</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">Logger</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="c1"># self.logger.setLogLevel(self.logger.Info)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">TRACE_ALL</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">l</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">info</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">l</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">warning</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">l</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">warning</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">error</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">l</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="n">l</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span> <span class="s1">&#39;Unable to initialize TaurusGraphicsSceneLogger: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">parent</span> <span class="ow">and</span> <span class="n">parent</span><span class="o">.</span><span class="n">panelClass</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">defaultClass</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">panelClass</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">defaultClass</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">defaultClass</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">panel_launcher</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getClass</span><span class="p">(</span><span class="n">defaultClass</span><span class="p">)</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel_launcher</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">panel_launcher</span> <span class="o">=</span> <span class="n">ExternalAppAction</span><span class="p">(</span>
                            <span class="n">defaultClass</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">panel_launcher</span> <span class="o">=</span> <span class="n">defaultClass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="kn">from</span> <span class="nn">taurus.qt.qtgui.graphic.jdraw</span> <span class="k">import</span> <span class="n">TaurusJDrawSynopticsView</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">panel_launcher</span> <span class="o">=</span> <span class="n">TaurusJDrawSynopticsView</span><span class="o">.</span><span class="n">defaultPanelClass</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">panel_launcher</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setSelectionMark</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">strt</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">closeAllPanels</span><span class="p">()</span>
        <span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsScene</span><span class="o">.</span><span class="fm">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

<div class="viewcode-block" id="TaurusGraphicsScene.showNewPanel"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsScene.html#taurus.qt.qtgui.graphic.TaurusGraphicsScene.showNewPanel">[docs]</a>    <span class="k">def</span> <span class="nf">showNewPanel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">standAlone</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">TaurusGraphicsItem</span><span class="p">):</span>
                <span class="n">objName</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">_name</span>
                <span class="n">clName</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">getExtensions</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;className&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel_launcher</span>
                <span class="c1"># classParams extension overrides Model; if there&#39;s no</span>
                <span class="c1"># extension then object name is used</span>
                <span class="n">clParam</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">getExtensions</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;classParams&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">objName</span>
                <span class="n">standAlone</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">standAlone</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">clName</span><span class="p">,</span> <span class="n">clParam</span><span class="p">,</span> <span class="n">objName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel_launcher</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">args</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">clName</span> <span class="ow">or</span> <span class="n">clName</span> <span class="o">==</span> <span class="s1">&#39;noPanel&#39;</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;TaurusGraphicsScene.showNewPanel(</span><span class="si">%s</span><span class="s1">,</span><span class="si">%s</span><span class="s1">,</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span>
                       <span class="p">(</span><span class="n">clName</span><span class="p">,</span> <span class="n">clParam</span><span class="p">,</span> <span class="n">objName</span><span class="p">))</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">clName</span><span class="p">,</span> <span class="n">ExternalAppAction</span><span class="p">):</span>
                <span class="n">clName</span><span class="o">.</span><span class="n">actionTriggered</span><span class="p">(</span><span class="n">clParam</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span>
                    <span class="n">clParam</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span> <span class="k">else</span> <span class="p">[</span><span class="n">clParam</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">clName</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">klass</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getClass</span><span class="p">(</span><span class="n">clName</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">klass</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> Class not found!&quot;</span> <span class="o">%</span> <span class="n">clName</span><span class="p">)</span>
                        <span class="n">klass</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getClass</span><span class="p">(</span><span class="s2">&quot;TaurusDevicePanel&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">klass</span><span class="p">,</span> <span class="n">clName</span> <span class="o">=</span> <span class="n">clName</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span>
                        <span class="n">clName</span><span class="p">,</span> <span class="s1">&#39;__name__&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">clName</span><span class="p">))</span>
                <span class="n">widget</span> <span class="o">=</span> <span class="n">klass</span><span class="p">()</span>  <span class="c1"># self.parent())</span>
                <span class="c1"># if isinstance(widget,taurus.qt.qtgui.panel.TaurusDevicePanel):</span>
                <span class="c1"># widget.setSpectraAtkMode(True) #Method renamed or deprecated</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">widget</span><span class="o">.</span><span class="n">setClasses</span><span class="p">(</span><span class="n">clParam</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">widget</span><span class="o">.</span><span class="n">setModel</span><span class="p">(</span><span class="n">clParam</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">widget</span><span class="o">.</span><span class="n">setTable</span><span class="p">(</span><span class="n">clParam</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>

                <span class="c1"># if isinstance(widget,Qt.QWidget):</span>
                    <span class="c1"># if not standAlone:</span>
                        <span class="c1">#obj = newDialog(self.parent())</span>
                    <span class="c1"># else:</span>
                        <span class="c1">#obj = newDialog()</span>
                    <span class="c1"># obj.initComponents(widget,objName,clName)</span>
                    <span class="c1"># obj.setModal(False)</span>
                    <span class="c1"># obj.setVisible(True)</span>

                <span class="n">widget</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">clName</span><span class="p">,</span> <span class="n">objName</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">panels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">widget</span><span class="p">)</span>
                <span class="n">widget</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  <span class="c1"># exec_()</span>
                <span class="k">return</span> <span class="n">widget</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span></div>

<div class="viewcode-block" id="TaurusGraphicsScene.closeAllPanels"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsScene.html#taurus.qt.qtgui.graphic.TaurusGraphicsScene.closeAllPanels">[docs]</a>    <span class="k">def</span> <span class="nf">closeAllPanels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; This method replaces killProcess, using taurus.qt.qtgui.util.ExternalAppAction instead! &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;In closeAllPanels(</span><span class="si">%s</span><span class="s1">,</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span>
                       <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panel_launcher</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">panels</span><span class="p">))</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panel_launcher</span><span class="p">,</span> <span class="n">ExternalAppAction</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">panel_launcher</span><span class="o">.</span><span class="n">kill</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">panels</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="s1">&#39;setModel&#39;</span><span class="p">):</span>
                        <span class="n">p</span><span class="o">.</span><span class="n">setModel</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                    <span class="n">p</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>
            <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">panels</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">panels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span></div>

<div class="viewcode-block" id="TaurusGraphicsScene.addItem"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsScene.html#taurus.qt.qtgui.graphic.TaurusGraphicsScene.addItem">[docs]</a>    <span class="k">def</span> <span class="nf">addItem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="c1"># self.debug(&#39;addItem(%s)&#39;%item)</span>
        <span class="k">def</span> <span class="nf">expand</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
            <span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;_name&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">name</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_itemnames</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="c1">#self.debug(&#39;addItem(%s): %s&#39;%(name,i))</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsItemGroup</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">i</span><span class="o">.</span><span class="n">childItems</span><span class="p">():</span>
                    <span class="n">expand</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
        <span class="n">expand</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsScene</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span></div>

<div class="viewcode-block" id="TaurusGraphicsScene.addWidget"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsScene.html#taurus.qt.qtgui.graphic.TaurusGraphicsScene.addWidget">[docs]</a>    <span class="k">def</span> <span class="nf">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;addWidget(</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="n">item</span><span class="p">)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="s1">&#39;_name&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">name</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_itemnames</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">flags</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsScene</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsScene</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span></div>

<div class="viewcode-block" id="TaurusGraphicsScene.getItemByName"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsScene.html#taurus.qt.qtgui.graphic.TaurusGraphicsScene.getItemByName">[docs]</a>    <span class="k">def</span> <span class="nf">getItemByName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item_name</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list with all items matching a given name.</span>

<span class="sd">        :param strict: (bool or None) controls whether full_name (strict=True) or only device name (False) must match</span>

<span class="sd">        :return: (list) items</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">strict</span> <span class="o">=</span> <span class="p">(</span>
            <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ANY_ATTRIBUTE_SELECTS_DEVICE</span><span class="p">)</span> <span class="k">if</span> <span class="n">strict</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">strict</span>
        <span class="n">alnum</span> <span class="o">=</span> <span class="s1">&#39;(?:[a-zA-Z0-9-_\*]|(?:\.\*))(?:[a-zA-Z0-9-_\*]|(?:\.\*))*&#39;</span>
        <span class="n">target</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">item_name</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
            <span class="s1">&#39;/state&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>  <span class="c1"># If it has spaces only the first word is used</span>
        <span class="c1"># Device names should match also its attributes or only state?</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">strict</span> <span class="ow">and</span> <span class="n">TangoAttributeNameValidator</span><span class="p">()</span><span class="o">.</span><span class="n">getUriGroups</span><span class="p">(</span><span class="n">target</span><span class="p">):</span>
            <span class="n">target</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">TangoDeviceNameValidator</span><span class="p">()</span><span class="o">.</span><span class="n">getUriGroups</span><span class="p">(</span><span class="n">target</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">strict</span><span class="p">:</span>
                <span class="n">target</span> <span class="o">+=</span> <span class="s1">&#39;(/state)?&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">target</span> <span class="o">+=</span> <span class="s1">&#39;(/&#39;</span> <span class="o">+</span> <span class="n">alnum</span> <span class="o">+</span> <span class="s1">&#39;)?&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">target</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;$&#39;</span><span class="p">):</span>
            <span class="n">target</span> <span class="o">+=</span> <span class="s1">&#39;$&#39;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_itemnames</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">k</span><span class="o">.</span><span class="n">lower</span><span class="p">()):</span>
                <span class="c1">#self.debug(&#39;getItemByName(%s): _itemnames[%s]: %s&#39;%(target,k,self._itemnames[k]))</span>
                <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_itemnames</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="TaurusGraphicsScene.getItemByPosition"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsScene.html#taurus.qt.qtgui.graphic.TaurusGraphicsScene.getItemByPosition">[docs]</a>    <span class="k">def</span> <span class="nf">getItemByPosition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; This method will try first with named objects; if failed then with itemAt &quot;&quot;&quot;</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">QPointF</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">itemsAtPos</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">z</span><span class="p">,</span> <span class="n">o</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">((</span><span class="n">i</span><span class="o">.</span><span class="n">zValue</span><span class="p">(),</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_itemnames</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">v</span> <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span> <span class="ow">or</span> <span class="n">i</span><span class="o">.</span><span class="n">isUnderMouse</span><span class="p">()):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="s1">&#39;getExtensions&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                    <span class="s1">&#39;getItemByPosition(</span><span class="si">%d</span><span class="s1">,</span><span class="si">%d</span><span class="s1">): adding Qt primitive </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">o</span><span class="p">))</span>
                <span class="n">itemsAtPos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">o</span><span class="o">.</span><span class="n">getExtensions</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;noSelect&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                    <span class="s1">&#39;getItemByPosition(</span><span class="si">%d</span><span class="s1">,</span><span class="si">%d</span><span class="s1">): adding GraphicsItem </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">o</span><span class="p">))</span>
                <span class="n">itemsAtPos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                    <span class="s1">&#39;getItemByPosition(</span><span class="si">%d</span><span class="s1">,</span><span class="si">%d</span><span class="s1">): object ignored, </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">o</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">itemsAtPos</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">itemsAtPos</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTaurusParentItem</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="ow">or</span> <span class="n">obj</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># return self.itemAt(x,y)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;getItemByPosition(</span><span class="si">%d</span><span class="s1">,</span><span class="si">%d</span><span class="s1">): no items found!&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
            <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="TaurusGraphicsScene.getItemClicked"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsScene.html#taurus.qt.qtgui.graphic.TaurusGraphicsScene.getItemClicked">[docs]</a>    <span class="k">def</span> <span class="nf">getItemClicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mouseEvent</span><span class="p">):</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">mouseEvent</span><span class="o">.</span><span class="n">scenePos</span><span class="p">()</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">pos</span><span class="o">.</span><span class="n">x</span><span class="p">(),</span> <span class="n">pos</span><span class="o">.</span><span class="n">y</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graphicSceneClicked</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">QPoint</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getItemByPosition</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="c1">#self.debug(&#39;mouse clicked on %s(%s) at (%s,%s)&#39;%(type(obj).__name__,getattr(obj,&#39;_name&#39;,&#39;&#39;),x,y))</span>
        <span class="k">return</span> <span class="n">obj</span></div>

<div class="viewcode-block" id="TaurusGraphicsScene.mousePressEvent"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsScene.html#taurus.qt.qtgui.graphic.TaurusGraphicsScene.mousePressEvent">[docs]</a>    <span class="k">def</span> <span class="nf">mousePressEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mouseEvent</span><span class="p">):</span>
        <span class="c1">#self.debug(&#39;In TaurusGraphicsScene.mousePressEvent(%s,%s))&#39;%(str(type(mouseEvent)),str(mouseEvent.button())))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getItemClicked</span><span class="p">(</span><span class="n">mouseEvent</span><span class="p">)</span>
            <span class="n">obj_name</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s1">&#39;_name&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">obj_name</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">QGraphicsTextBoxing</span><span class="p">):</span>
                <span class="n">obj_name</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">()</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">mouseEvent</span><span class="o">.</span><span class="n">button</span><span class="p">()</span> <span class="o">==</span> <span class="n">Qt</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">LeftButton</span><span class="p">):</span>
                <span class="c1"># A null obj_name should deselect all, we don&#39;t send obj</span>
                <span class="c1"># because we want all similar to be matched</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">selectGraphicItem</span><span class="p">(</span><span class="n">obj_name</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                        <span class="s1">&#39; =&gt; graphicItemSelected(QString)(</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="n">obj_name</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">graphicItemSelected</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">obj_name</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># It should send None but the signature do not allow it</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">graphicItemSelected</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

            <span class="k">def</span> <span class="nf">addMenuAction</span><span class="p">(</span><span class="n">menu</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">last_was_separator</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">k</span><span class="p">:</span>
                        <span class="n">configDialogAction</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">action</span><span class="p">:</span>
                            <span class="n">configDialogAction</span><span class="o">.</span><span class="n">triggered</span><span class="p">[()]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span> <span class="n">dev</span><span class="o">=</span><span class="n">obj_name</span><span class="p">,</span> <span class="n">act</span><span class="o">=</span><span class="n">action</span><span class="p">:</span> <span class="n">act</span><span class="p">(</span><span class="n">dev</span><span class="p">))</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">configDialogAction</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                        <span class="n">last_was_separator</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">elif</span> <span class="ow">not</span> <span class="n">last_was_separator</span><span class="p">:</span>
                        <span class="n">menu</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>
                        <span class="n">last_was_separator</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Unable to add Menu Action: </span><span class="si">%s</span><span class="s1">:</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>
                <span class="k">return</span> <span class="n">last_was_separator</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">mouseEvent</span><span class="o">.</span><span class="n">button</span><span class="p">()</span> <span class="o">==</span> <span class="n">Qt</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">RightButton</span><span class="p">):</span>
                <span class="sd">&#39;&#39;&#39; This function is called when right clicking on TaurusDevTree area. A pop up menu will be shown with the available options. &#39;&#39;&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;RightButton Mouse Event on </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">obj_name</span><span class="p">))</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">TaurusGraphicsItem</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">obj_name</span> <span class="ow">or</span> <span class="n">obj</span><span class="o">.</span><span class="n">contextMenu</span><span class="p">()</span> <span class="ow">or</span> <span class="n">obj</span><span class="o">.</span><span class="n">getExtensions</span><span class="p">()):</span>
                    <span class="n">menu</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">QMenu</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>  <span class="c1"># self.parent)</span>
                    <span class="n">last_was_separator</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="n">extensions</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">getExtensions</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">obj_name</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">extensions</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">extensions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;className&#39;</span><span class="p">)):</span>
                        <span class="c1"># menu.addAction(obj_name)</span>
                        <span class="n">addMenuAction</span><span class="p">(</span><span class="n">menu</span><span class="p">,</span> <span class="s1">&#39;Show </span><span class="si">%s</span><span class="s1"> panel&#39;</span> <span class="o">%</span> <span class="n">obj_name</span><span class="p">,</span>
                                      <span class="k">lambda</span> <span class="n">x</span><span class="o">=</span><span class="n">obj_name</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">showNewPanel</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">contextMenu</span><span class="p">():</span>
                        <span class="k">if</span> <span class="n">obj_name</span><span class="p">:</span>
                            <span class="n">menu</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>
                            <span class="n">last_was_separator</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">contextMenu</span><span class="p">():</span>  <span class="c1"># It must be a list of tuples (ActionName,ActionMethod)</span>
                            <span class="n">last_was_separator</span> <span class="o">=</span> <span class="n">addMenuAction</span><span class="p">(</span>
                                <span class="n">menu</span><span class="p">,</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">last_was_separator</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">extensions</span><span class="p">:</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">menu</span><span class="o">.</span><span class="n">isEmpty</span><span class="p">():</span>
                            <span class="n">menu</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>
                        <span class="n">className</span> <span class="o">=</span> <span class="n">extensions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;className&#39;</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">className</span> <span class="ow">and</span> <span class="n">className</span> <span class="o">!=</span> <span class="s1">&#39;noPanel&#39;</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;launching className extension object&#39;</span><span class="p">)</span>
                            <span class="n">addMenuAction</span><span class="p">(</span><span class="n">menu</span><span class="p">,</span> <span class="s1">&#39;Show </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">className</span><span class="p">,</span>
                                          <span class="k">lambda</span> <span class="n">d</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">obj</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">showNewPanel</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
                        <span class="k">if</span> <span class="n">extensions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;shellCommand&#39;</span><span class="p">):</span>
                            <span class="n">addMenuAction</span><span class="p">(</span><span class="n">menu</span><span class="p">,</span> <span class="s1">&#39;Execute&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">d</span><span class="p">,</span>
                                          <span class="n">x</span><span class="o">=</span><span class="n">obj</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">getShellCommand</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">menu</span><span class="o">.</span><span class="n">isEmpty</span><span class="p">():</span>
                        <span class="n">menu</span><span class="o">.</span><span class="n">exec_</span><span class="p">(</span>
                            <span class="n">Qt</span><span class="o">.</span><span class="n">QPoint</span><span class="p">(</span><span class="n">mouseEvent</span><span class="o">.</span><span class="n">screenPos</span><span class="p">()</span><span class="o">.</span><span class="n">x</span><span class="p">(),</span> <span class="n">mouseEvent</span><span class="o">.</span><span class="n">screenPos</span><span class="p">()</span><span class="o">.</span><span class="n">y</span><span class="p">()))</span>
                    <span class="k">del</span> <span class="n">menu</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span></div>

<div class="viewcode-block" id="TaurusGraphicsScene.mouseDoubleClickEvent"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsScene.html#taurus.qt.qtgui.graphic.TaurusGraphicsScene.mouseDoubleClickEvent">[docs]</a>    <span class="k">def</span> <span class="nf">mouseDoubleClickEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getItemClicked</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
            <span class="n">obj_name</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s1">&#39;_name&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">class_name</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">getExtensions</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;className&#39;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">class_name</span> <span class="o">=</span> <span class="s1">&#39;noPanel&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Clicked (</span><span class="si">%s</span><span class="s1">,</span><span class="si">%s</span><span class="s1">,</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">obj_name</span><span class="p">,</span> <span class="n">class_name</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">obj_name</span> <span class="ow">and</span> <span class="n">class_name</span> <span class="o">!=</span> <span class="s1">&#39;noPanel&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">showNewPanel</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span></div>

<div class="viewcode-block" id="TaurusGraphicsScene.setSelectionStyle"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsScene.html#taurus.qt.qtgui.graphic.TaurusGraphicsScene.setSelectionStyle">[docs]</a>    <span class="k">def</span> <span class="nf">setSelectionStyle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selectionStyle</span><span class="p">):</span>
        <span class="c1"># TODO We should test that selectionStyle is part of</span>
        <span class="c1"># SynopticSelectionStyle but there is nothing about it</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_selectionStyle</span> <span class="o">=</span> <span class="n">selectionStyle</span></div>

<div class="viewcode-block" id="TaurusGraphicsScene.selectGraphicItem"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsScene.html#taurus.qt.qtgui.graphic.TaurusGraphicsScene.selectGraphicItem">[docs]</a>    <span class="k">def</span> <span class="nf">selectGraphicItem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A blue circle is drawn around the matching item name.</span>
<span class="sd">        If the item_name is empty, or it is a reserved keyword, or it has the &quot;noSelect&quot; extension, then the blue circle is removed from the synoptic.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#self.debug(&#39;In TaurusGraphicsScene.selectGraphicItem(%s))&#39;%item_name)</span>
        <span class="n">selected</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="s1">&#39;_name&#39;</span><span class="p">,</span> <span class="n">item</span><span class="p">))</span>
                    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selectedItems</span> <span class="k">if</span> <span class="n">item</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">selected</span><span class="p">:</span>
            <span class="n">iname</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">item_name</span><span class="p">,</span> <span class="s1">&#39;_name&#39;</span><span class="p">,</span> <span class="n">item_name</span><span class="p">))</span>
            <span class="c1">#self.debug(&#39;In TauGraphicsScene.selectGraphicItem(%s): already selected: %s&#39;%(iname,selected))</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">iname</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">clearSelection</span><span class="p">()</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="k">elif</span> <span class="nb">any</span><span class="p">(</span><span class="n">iname</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">selected</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">clearSelection</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                    <span class="s1">&#39;In TauGraphicsScene.selectGraphicItem(</span><span class="si">%s</span><span class="s1">): already selected!&#39;</span> <span class="o">%</span> <span class="n">item_name</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">item_name</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="p">(</span><span class="n">TaurusGraphicsItem</span><span class="p">,</span> <span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsItem</span><span class="p">)):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">item_name</span><span class="p">,</span> <span class="s1">&#39;_name&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                    <span class="s1">&#39;In TauGraphicsScene.selectGraphicItem(</span><span class="si">%s</span><span class="s1">): item name not found.&#39;</span> <span class="o">%</span> <span class="n">item_name</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="n">item_name</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">taurus.qt.qtgui.graphic</span> <span class="k">import</span> <span class="n">jdraw_parser</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">item_name</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">item_name</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;JD&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">str</span><span class="p">(</span><span class="n">item_name</span><span class="p">)</span> <span class="ow">in</span> <span class="n">jdraw_parser</span><span class="o">.</span><span class="n">reserved</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                    <span class="s1">&#39;In TauGraphicsScene.selectGraphicItem(</span><span class="si">%s</span><span class="s1">): item name not found or name is a reserved keyword.&#39;</span> <span class="o">%</span> <span class="n">item_name</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="n">items</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getItemByName</span><span class="p">(</span><span class="n">item_name</span><span class="p">)</span> <span class="ow">or</span> <span class="p">[]</span>
            <span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">items</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTaurusParentItem</span><span class="p">(</span>
                <span class="n">i</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">items</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selectedItems</span><span class="p">)]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;In TaurusGraphicsScene.selectGraphicItem(</span><span class="si">%s</span><span class="s1">)): matched </span><span class="si">%d</span><span class="s1"> items&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">item_name</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selectionStyle</span> <span class="o">==</span> <span class="n">SynopticSelectionStyle</span><span class="o">.</span><span class="n">ELLIPSE</span><span class="p">:</span>
            <span class="n">displaySelection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_displaySelectionAsEllipse</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selectionStyle</span> <span class="o">==</span> <span class="n">SynopticSelectionStyle</span><span class="o">.</span><span class="n">OUTLINE</span><span class="p">:</span>
            <span class="n">displaySelection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_displaySelectionAsOutline</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Unexpected selectionStyle &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span>
                            <span class="n">SynopticSelectionStyle</span><span class="o">.</span><span class="n">whatis</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_selectionStyle</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">displaySelection</span><span class="p">(</span><span class="n">items</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_displaySelectionAsEllipse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">):</span>
        <span class="n">retval</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">((</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">TaurusGraphicsItem</span><span class="p">)</span> <span class="ow">and</span> <span class="n">item</span><span class="o">.</span><span class="n">getExtensions</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;noSelect&#39;</span><span class="p">))</span>
                            <span class="ow">or</span> <span class="p">(</span><span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selection</span><span class="p">)</span>
                            <span class="c1"># or (item in tangoGroup)</span>
                        <span class="p">):</span>
                    <span class="k">continue</span>
                <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">x</span><span class="p">(),</span> <span class="n">item</span><span class="o">.</span><span class="n">y</span><span class="p">()</span>
                <span class="n">rect</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span>
                <span class="n">srect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sceneRect</span><span class="p">()</span>
                <span class="c1"># 0 has to be excluded to check grouped element</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sceneRect</span><span class="p">()</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="n">srect</span><span class="o">.</span><span class="n">height</span><span class="p">()):</span>
                    <span class="n">rx</span><span class="p">,</span> <span class="n">ry</span> <span class="o">=</span> <span class="n">rect</span><span class="o">.</span><span class="n">topLeft</span><span class="p">()</span><span class="o">.</span><span class="n">x</span><span class="p">(),</span> <span class="n">rect</span><span class="o">.</span><span class="n">topLeft</span><span class="p">()</span><span class="o">.</span><span class="n">y</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">position not well mapped (</span><span class="si">%s</span><span class="s1">,</span><span class="si">%s</span><span class="s1">), using rect bound (</span><span class="si">%s</span><span class="s1">,</span><span class="si">%s</span><span class="s1">) instead&#39;</span> <span class="o">%</span> <span class="p">(</span>
                        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">rx</span><span class="p">,</span> <span class="n">ry</span><span class="p">))</span>
                    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">rx</span><span class="p">,</span> <span class="n">ry</span>  <span class="c1"># If the object is in the corner it will be also 0</span>
                <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">rect</span><span class="o">.</span><span class="n">width</span><span class="p">(),</span> <span class="n">rect</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Cannot draw SelectionMark for </span><span class="si">%s</span><span class="s1">(</span><span class="si">%s</span><span class="s1">)(</span><span class="si">%s</span><span class="s1">,</span><span class="si">%s</span><span class="s1">) in a negative position (</span><span class="si">%f</span><span class="s1">,</span><span class="si">%f</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span>
                        <span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">item</span><span class="o">.</span><span class="n">_name</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="n">TaurusTextAttributeItem</span><span class="p">,</span> <span class="n">TaurusTextStateItem</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getSelectionMark</span><span class="p">(),</span> <span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsPixmapItem</span><span class="p">):</span>
                        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">20</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">drawSelectionMark</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;&gt; Moved the SelectionMark to item </span><span class="si">%s</span><span class="s1">(</span><span class="si">%s</span><span class="s1">)(</span><span class="si">%s</span><span class="s1">,</span><span class="si">%s</span><span class="s1">) at </span><span class="si">%f</span><span class="s1">,</span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                        <span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">item</span><span class="o">.</span><span class="n">_name</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">item</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selectedItems</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_selectedItems</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                <span class="n">retval</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;selectGraphicsItem(</span><span class="si">%s</span><span class="s1">) failed! </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span>
                             <span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="s1">&#39;_name&#39;</span><span class="p">,</span> <span class="n">item</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
                <span class="c1"># return False</span>
        <span class="k">return</span> <span class="n">retval</span>

    <span class="k">def</span> <span class="nf">_displaySelectionAsOutline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">_outline</span><span class="p">(</span><span class="n">shapes</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;&quot;Compute the boolean union from a list of QGraphicsItem. &quot;&quot;&quot;</span>
            <span class="n">shape</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="c1"># TODO we can use a stack instead of recursivity</span>
            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">shapes</span><span class="p">:</span>
                <span class="c1"># TODO we should skip text and things like that</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">TaurusGroupItem</span><span class="p">):</span>
                    <span class="n">s</span> <span class="o">=</span> <span class="n">_outline</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">childItems</span><span class="p">())</span>
                    <span class="k">if</span> <span class="n">s</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">continue</span>

                <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">shape</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">shape</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">shape</span> <span class="o">=</span> <span class="n">shape</span><span class="o">.</span><span class="n">united</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">shape</span> <span class="o">=</span> <span class="n">s</span>

            <span class="k">if</span> <span class="n">shape</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>

            <span class="k">return</span> <span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsPathItem</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>

        <span class="c1"># TODO we can cache the outline instead of computing it again and again</span>
        <span class="n">selectionShape</span> <span class="o">=</span> <span class="n">_outline</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">selectionShape</span><span class="p">:</span>
            <span class="c1"># copy-paste from getSelectionMark</span>
            <span class="n">color</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">QColor</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">blue</span><span class="p">)</span>
            <span class="n">color</span><span class="o">.</span><span class="n">setAlphaF</span><span class="p">(</span><span class="o">.</span><span class="mi">10</span><span class="p">)</span>
            <span class="n">pen</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">QPen</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">SolidLine</span><span class="p">)</span>
            <span class="n">pen</span><span class="o">.</span><span class="n">setWidth</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
            <span class="n">pen</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">QColor</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">blue</span><span class="p">))</span>
            <span class="n">selectionShape</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
            <span class="n">selectionShape</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">pen</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">item</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selectedItems</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_selectedItems</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

            <span class="c1"># TODO i dont think this function work... or i dont know how...</span>
            <span class="c1"># self.setSelectionMark(picture=selectionShape)</span>
            <span class="c1"># ... Then do it it with hands...</span>
            <span class="c1"># copy-paste from drawSelectionMark</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_selection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">selectionShape</span><span class="p">)</span>
            <span class="c1"># It&#39;s better to add it hidden to avoid resizings</span>
            <span class="n">selectionShape</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">selectionShape</span><span class="p">)</span>
            <span class="c1"># Put on Top</span>
            <span class="n">selectionShape</span><span class="o">.</span><span class="n">setZValue</span><span class="p">(</span><span class="mi">9999</span><span class="p">)</span>
            <span class="n">selectionShape</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">updateSceneViews</span><span class="p">()</span>

            <span class="k">return</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="kc">False</span>

<div class="viewcode-block" id="TaurusGraphicsScene.clearSelection"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsScene.html#taurus.qt.qtgui.graphic.TaurusGraphicsScene.clearSelection">[docs]</a>    <span class="k">def</span> <span class="nf">clearSelection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1">#self.debug(&#39;In clearSelection([%d])&#39;%len(self._selectedItems))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selection</span><span class="p">:</span>
            <span class="n">i</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">removeItem</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_selection</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_selectedItems</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateSceneViews</span><span class="p">()</span></div>

<div class="viewcode-block" id="TaurusGraphicsScene.setSelectionMark"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsScene.html#taurus.qt.qtgui.graphic.TaurusGraphicsScene.setSelectionMark">[docs]</a>    <span class="k">def</span> <span class="nf">setSelectionMark</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">picture</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method allows to set a callable, graphic item or pixmap as selection mark (by default creates a blue circle).</span>
<span class="sd">        If picture is a callable, the object returned will be used as selection mark.</span>
<span class="sd">        If picture is a QGraphicsItem it will be used as selection mark.</span>
<span class="sd">        If picture is a QPixmap or a path to a pixmap a QGraphicsPixmapItem will be created.</span>
<span class="sd">        If no picture is provided, a blue ellipse will be drawn around the selected object.</span>
<span class="sd">        h/w will be used for height/width of the drawn object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#self.debug(&#39;In setSelectionMark(%s,%d,%d)&#39;%(picture,w,h))</span>
        <span class="k">if</span> <span class="n">picture</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SelectionMark</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Reset of previous icon generators</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SelectionMark</span> <span class="o">=</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">p</span><span class="o">=</span><span class="n">picture</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">w</span><span class="p">,</span>
                                  <span class="n">y</span><span class="o">=</span><span class="n">h</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">getSelectionMark</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">SelectionMark</span></div>

<div class="viewcode-block" id="TaurusGraphicsScene.getSelectionMark"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsScene.html#taurus.qt.qtgui.graphic.TaurusGraphicsScene.getSelectionMark">[docs]</a>    <span class="k">def</span> <span class="nf">getSelectionMark</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">picture</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">picture</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">SelectionMark</span><span class="p">:</span>
                <span class="n">SelectionMark</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SelectionMark</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">SelectionMark</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsEllipseItem</span><span class="p">()</span>
                <span class="n">color</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">QColor</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">blue</span><span class="p">)</span>
                <span class="n">color</span><span class="o">.</span><span class="n">setAlphaF</span><span class="p">(</span><span class="o">.</span><span class="mi">10</span><span class="p">)</span>
                <span class="n">SelectionMark</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
                <span class="n">pen</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">QPen</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">CustomDashLine</span><span class="p">)</span>
                <span class="n">pen</span><span class="o">.</span><span class="n">setWidth</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
                <span class="n">pen</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">QColor</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">blue</span><span class="p">))</span>
                <span class="n">SelectionMark</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">pen</span><span class="p">)</span>
                <span class="n">SelectionMark</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span>  <span class="c1"># It&#39;s better to add it hidden to avoid resizings</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">picture</span><span class="p">,</span> <span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsItem</span><span class="p">):</span>
                    <span class="n">SelectionMark</span> <span class="o">=</span> <span class="n">picture</span>
                    <span class="n">SelectionMark</span><span class="o">.</span><span class="n">setRect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
                    <span class="n">SelectionMark</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span>
                <span class="k">elif</span> <span class="n">operator</span><span class="o">.</span><span class="n">isCallable</span><span class="p">(</span><span class="n">picture</span><span class="p">):</span>
                    <span class="n">SelectionMark</span> <span class="o">=</span> <span class="n">picture</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">picture</span><span class="p">,</span> <span class="n">Qt</span><span class="o">.</span><span class="n">QPixmap</span><span class="p">):</span>
                        <span class="n">pixmap</span> <span class="o">=</span> <span class="n">picture</span>
                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">picture</span><span class="p">,</span> <span class="n">basestring</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">picture</span><span class="p">,</span> <span class="n">Qt</span><span class="o">.</span><span class="n">QString</span><span class="p">):</span>
                        <span class="n">picture</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">picture</span><span class="p">)</span>
                        <span class="n">pixmap</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">QPixmap</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">picture</span><span class="p">))</span>
                    <span class="n">SelectionMark</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsPixmapItem</span><span class="p">()</span>
                    <span class="n">SelectionMark</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">pixmap</span><span class="o">.</span><span class="n">scaled</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">))</span>
                    <span class="n">SelectionMark</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;In setSelectionMark(</span><span class="si">%s</span><span class="s1">): </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span>
                           <span class="p">(</span><span class="n">picture</span><span class="p">,</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()))</span>
                <span class="n">picture</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">SelectionMark</span></div>

<div class="viewcode-block" id="TaurusGraphicsScene.drawSelectionMark"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsScene.html#taurus.qt.qtgui.graphic.TaurusGraphicsScene.drawSelectionMark">[docs]</a>    <span class="k">def</span> <span class="nf">drawSelectionMark</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">oversize</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If h or w are None the mark is drawn at x,y</span>
<span class="sd">        If h or w has a value the mark is drawn in the center of the region ((x,y)(x+w,y+h))</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#self.debug(&#39;%s has parent %s&#39; % (item_name,getattr(item.parentItem(),&#39;_name&#39;,&#39;ung&#39;)  if item.parentItem() else &#39;None&#39;))</span>
        <span class="c1">#self.debug(&#39;drawSelectionMark(): center and width,height are: (%d,%d),(%d,%d)&#39; % (x,y,w,h))</span>

        <span class="n">mark</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getSelectionMark</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_selection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mark</span><span class="p">)</span>
        <span class="n">srect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">itemsBoundingRect</span><span class="p">()</span>
        <span class="n">MAX_CIRCLE_SIZE</span> <span class="o">=</span> <span class="n">srect</span><span class="o">.</span><span class="n">width</span><span class="p">(),</span> <span class="n">srect</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>  <span class="c1"># 500,500 #20,20</span>
        <span class="n">LIMITS</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">srect</span><span class="o">.</span><span class="n">width</span><span class="p">(),</span> <span class="n">srect</span><span class="o">.</span><span class="n">height</span><span class="p">())</span>

        <span class="k">def</span> <span class="nf">bound</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">LIMITS</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot; x,y,w,h &quot;&quot;&quot;</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">coords</span>
            <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">w</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">w</span> <span class="o">-</span> <span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">),</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">h</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">h</span> <span class="o">-</span> <span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">y</span><span class="p">),</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">x</span> <span class="o">+</span> <span class="n">w</span> <span class="o">&gt;</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
                <span class="n">w</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">),</span> <span class="n">x</span>
            <span class="k">if</span> <span class="n">y</span> <span class="o">+</span> <span class="n">h</span> <span class="o">&gt;</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span>
                <span class="n">h</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">y</span><span class="p">),</span> <span class="n">y</span>
            <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mark</span><span class="p">,</span> <span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsEllipseItem</span><span class="p">):</span>
            <span class="k">if</span> <span class="kc">None</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">w</span> <span class="o">&gt;</span> <span class="n">MAX_CIRCLE_SIZE</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="n">h</span> <span class="o">&gt;</span> <span class="n">MAX_CIRCLE_SIZE</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="c1"># Applying correction if the file is too big, half max</span>
                    <span class="c1"># circle size around the center</span>
                    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">w</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span> <span class="o">*</span> \
                        <span class="n">MAX_CIRCLE_SIZE</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="n">h</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span> <span class="o">*</span> \
                        <span class="n">MAX_CIRCLE_SIZE</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                    <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="p">[</span><span class="o">.</span><span class="mi">5</span> <span class="o">*</span> <span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">MAX_CIRCLE_SIZE</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span> <span class="o">*</span> <span class="n">w</span><span class="p">,</span> <span class="n">y</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span> <span class="o">*</span> <span class="n">h</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="p">[</span><span class="o">.</span><span class="mi">5</span> <span class="o">*</span> <span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">MAX_CIRCLE_SIZE</span><span class="p">]</span>
                <span class="c1">#self.debug(&#39;drawSelectionMark(): center and width,height are: (%d,%d),(%d,%d)&#39; % (x,y,w,h))</span>
            <span class="n">mark</span><span class="o">.</span><span class="n">setRect</span><span class="p">(</span><span class="o">*</span><span class="n">bound</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">h</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)))</span>
            <span class="c1"># mark.setRect(x,y,w*2,h*2)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mark</span><span class="p">,</span> <span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsPixmapItem</span><span class="p">):</span>
            <span class="n">rect</span> <span class="o">=</span> <span class="n">mark</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span>
            <span class="k">if</span> <span class="kc">None</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">]:</span>
                <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="o">.</span><span class="mi">5</span> <span class="o">*</span> <span class="n">w</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="o">.</span><span class="mi">5</span> <span class="o">*</span> <span class="n">h</span>
            <span class="n">mark</span><span class="o">.</span><span class="n">setOffset</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span> <span class="o">*</span> <span class="n">rect</span><span class="o">.</span><span class="n">width</span><span class="p">(),</span> <span class="n">y</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span> <span class="o">*</span> <span class="n">rect</span><span class="o">.</span><span class="n">height</span><span class="p">())</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mark</span><span class="p">,</span> <span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsItem</span><span class="p">):</span>
            <span class="n">mark</span><span class="o">.</span><span class="n">setRect</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>

        <span class="n">mark</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span>  <span class="c1"># It&#39;s better to add it hidden to avoid resizings</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">mark</span><span class="p">)</span>
        <span class="n">mark</span><span class="o">.</span><span class="n">setZValue</span><span class="p">(</span><span class="mi">9999</span><span class="p">)</span>  <span class="c1"># Put on Top</span>
        <span class="n">mark</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateSceneViews</span><span class="p">()</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="TaurusGraphicsScene.getShellCommand"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsScene.html#taurus.qt.qtgui.graphic.TaurusGraphicsScene.getShellCommand">[docs]</a>    <span class="k">def</span> <span class="nf">getShellCommand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">shellCom</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">getExtensions</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;shellCommand&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
            <span class="s1">&#39;$NAME&#39;</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">_name</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;$MODEL&#39;</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">wait</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">shellCom</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;&amp;&#39;</span><span class="p">):</span>
            <span class="n">shellCom</span> <span class="o">+=</span> <span class="s1">&#39; &amp;&#39;</span>
        <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">noPrompt</span><span class="p">:</span>
            <span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">shellCom</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">yes</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span>
            <span class="n">no</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Cancel</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">question</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">(</span>
            <span class="p">),</span> <span class="s2">&quot;Shell command&quot;</span><span class="p">,</span> <span class="s2">&quot;Would you like to call shell command &#39;&quot;</span> <span class="o">+</span> <span class="n">shellCom</span> <span class="o">+</span> <span class="s2">&quot;&#39; ?&quot;</span><span class="p">,</span> <span class="n">yes</span><span class="p">,</span> <span class="n">no</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">result</span> <span class="o">==</span> <span class="n">yes</span><span class="p">:</span>
                <span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">shellCom</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="TaurusGraphicsScene.getClass"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsScene.html#taurus.qt.qtgui.graphic.TaurusGraphicsScene.getClass">[docs]</a>    <span class="k">def</span> <span class="nf">getClass</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clName</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">clName</span> <span class="ow">or</span> <span class="n">clName</span> <span class="o">==</span> <span class="s1">&#39;noPanel&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="n">clName</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;atkpanel.MainPanel&#39;</span><span class="p">,</span> <span class="s1">&#39;atkpanel&#39;</span><span class="p">):</span>
            <span class="n">clName</span> <span class="o">=</span> <span class="s1">&#39;TaurusDevicePanel&#39;</span>
        <span class="c1"># TODO: allow passing class names including module, e.g.: &#39;foo.Bar&#39;</span>
        <span class="k">if</span> <span class="n">clName</span> <span class="ow">in</span> <span class="nb">globals</span><span class="p">():</span>
            <span class="k">return</span> <span class="nb">globals</span><span class="p">()[</span><span class="n">clName</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">clName</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">():</span>
            <span class="k">return</span> <span class="nb">locals</span><span class="p">()[</span><span class="n">clName</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">clName</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">Qt</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">Qt</span><span class="p">,</span> <span class="n">clName</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">wf</span> <span class="o">=</span> <span class="n">TaurusWidgetFactory</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">wf</span><span class="o">.</span><span class="n">getTaurusWidgetClass</span><span class="p">(</span><span class="n">clName</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span></div>

    <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="TaurusGraphicsScene.getTaurusParentItem"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsScene.html#taurus.qt.qtgui.graphic.TaurusGraphicsScene.getTaurusParentItem">[docs]</a>    <span class="k">def</span> <span class="nf">getTaurusParentItem</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Searches within a group hierarchy and returns a parent Taurus component or None if no parent TaurusBaseComponent</span>
<span class="sd">            is found.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">first</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">item</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span>
        <span class="k">while</span> <span class="n">p</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">TaurusGraphicsItem</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">first</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">first</span> <span class="o">=</span> <span class="n">p</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">top</span><span class="p">:</span>
                        <span class="k">break</span>
                <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">getModel</span><span class="p">())</span> <span class="o">!=</span> <span class="nb">str</span><span class="p">(</span><span class="n">first</span><span class="o">.</span><span class="n">getModel</span><span class="p">()):</span>
                    <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">first</span> <span class="o">=</span> <span class="n">p</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">first</span></div>

<div class="viewcode-block" id="TaurusGraphicsScene.getAllChildren"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsScene.html#taurus.qt.qtgui.graphic.TaurusGraphicsScene.getAllChildren">[docs]</a>    <span class="k">def</span> <span class="nf">getAllChildren</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">klass</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns all children elements, filtering by klass if wanted &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">children</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">childItems</span><span class="p">()</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                <span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">children</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">klass</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">klass</span><span class="p">))</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">childItems</span><span class="p">()</span>
                          <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">children</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">klass</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">klass</span><span class="p">))</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="TaurusGraphicsScene.start"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsScene.html#taurus.qt.qtgui.graphic.TaurusGraphicsScene.start">[docs]</a>    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">updateThread</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateQueue</span> <span class="o">=</span> <span class="n">Queue</span><span class="o">.</span><span class="n">Queue</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateThread</span> <span class="o">=</span> <span class="n">TaurusGraphicsUpdateThread</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateThread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>  <span class="c1"># Qt.QThread.HighPriority)</span></div>

<div class="viewcode-block" id="TaurusGraphicsScene.getQueue"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsScene.html#taurus.qt.qtgui.graphic.TaurusGraphicsScene.getQueue">[docs]</a>    <span class="k">def</span> <span class="nf">getQueue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">updateQueue</span></div>

<div class="viewcode-block" id="TaurusGraphicsScene.updateSceneItem"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsScene.html#taurus.qt.qtgui.graphic.TaurusGraphicsScene.updateSceneItem">[docs]</a>    <span class="k">def</span> <span class="nf">updateSceneItem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateQueue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">item</span><span class="p">)</span></div>

<div class="viewcode-block" id="TaurusGraphicsScene.updateSceneItems"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsScene.html#taurus.qt.qtgui.graphic.TaurusGraphicsScene.updateSceneItems">[docs]</a>    <span class="k">def</span> <span class="nf">updateSceneItems</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateQueue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">items</span><span class="p">)</span></div>

<div class="viewcode-block" id="TaurusGraphicsScene.updateScene"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsScene.html#taurus.qt.qtgui.graphic.TaurusGraphicsScene.updateScene">[docs]</a>    <span class="k">def</span> <span class="nf">updateScene</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span></div>

<div class="viewcode-block" id="TaurusGraphicsScene.updateSceneViews"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsScene.html#taurus.qt.qtgui.graphic.TaurusGraphicsScene.updateSceneViews">[docs]</a>    <span class="k">def</span> <span class="nf">updateSceneViews</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">():</span>
            <span class="n">v</span><span class="o">.</span><span class="n">viewport</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
            <span class="c1"># v.invalidateScene(self.SelectionCircle.boundingRect())</span>
        <span class="k">return</span></div></div>


<div class="viewcode-block" id="QGraphicsTextBoxing"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_QGraphicsTextBoxing.html#taurus.qt.qtgui.graphic.QGraphicsTextBoxing">[docs]</a><span class="k">class</span> <span class="nc">QGraphicsTextBoxing</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsItemGroup</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Display a text inside a virtual box. Support horizontal and vertical alignment&quot;&quot;&quot;</span>

    <span class="n">_TEXT_RATIO</span> <span class="o">=</span> <span class="mf">0.8</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scene</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsItemGroup</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">scene</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rect</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsRectItem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scene</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rect</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">QBrush</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoBrush</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rect</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">QPen</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoPen</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_text</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsTextItem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scene</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_TEXT_RATIO</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_TEXT_RATIO</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validBackground</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># using that like the previous code create a worst result</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__layoutValide</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_alignment</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span> <span class="o">|</span> <span class="n">Qt</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignVCenter</span>

<div class="viewcode-block" id="QGraphicsTextBoxing.setRect"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_QGraphicsTextBoxing.html#taurus.qt.qtgui.graphic.QGraphicsTextBoxing.setRect">[docs]</a>    <span class="k">def</span> <span class="nf">setRect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rect</span><span class="o">.</span><span class="n">setRect</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_invalidateLayout</span><span class="p">()</span></div>

<div class="viewcode-block" id="QGraphicsTextBoxing.setPlainText"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_QGraphicsTextBoxing.html#taurus.qt.qtgui.graphic.QGraphicsTextBoxing.setPlainText">[docs]</a>    <span class="k">def</span> <span class="nf">setPlainText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="o">.</span><span class="n">setPlainText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_invalidateLayout</span><span class="p">()</span></div>

<div class="viewcode-block" id="QGraphicsTextBoxing.setValidBackground"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_QGraphicsTextBoxing.html#taurus.qt.qtgui.graphic.QGraphicsTextBoxing.setValidBackground">[docs]</a>    <span class="k">def</span> <span class="nf">setValidBackground</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validBackground</span> <span class="o">=</span> <span class="n">color</span></div>

<div class="viewcode-block" id="QGraphicsTextBoxing.toPlainText"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_QGraphicsTextBoxing.html#taurus.qt.qtgui.graphic.QGraphicsTextBoxing.toPlainText">[docs]</a>    <span class="k">def</span> <span class="nf">toPlainText</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">()</span></div>

<div class="viewcode-block" id="QGraphicsTextBoxing.brush"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_QGraphicsTextBoxing.html#taurus.qt.qtgui.graphic.QGraphicsTextBoxing.brush">[docs]</a>    <span class="k">def</span> <span class="nf">brush</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rect</span><span class="o">.</span><span class="n">brush</span><span class="p">()</span></div>

<div class="viewcode-block" id="QGraphicsTextBoxing.setBrush"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_QGraphicsTextBoxing.html#taurus.qt.qtgui.graphic.QGraphicsTextBoxing.setBrush">[docs]</a>    <span class="k">def</span> <span class="nf">setBrush</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">brush</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rect</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">brush</span><span class="p">)</span></div>

<div class="viewcode-block" id="QGraphicsTextBoxing.pen"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_QGraphicsTextBoxing.html#taurus.qt.qtgui.graphic.QGraphicsTextBoxing.pen">[docs]</a>    <span class="k">def</span> <span class="nf">pen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rect</span><span class="o">.</span><span class="n">pen</span><span class="p">()</span></div>

<div class="viewcode-block" id="QGraphicsTextBoxing.setPen"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_QGraphicsTextBoxing.html#taurus.qt.qtgui.graphic.QGraphicsTextBoxing.setPen">[docs]</a>    <span class="k">def</span> <span class="nf">setPen</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pen</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rect</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">pen</span><span class="p">)</span></div>

<div class="viewcode-block" id="QGraphicsTextBoxing.setDefaultTextColor"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_QGraphicsTextBoxing.html#taurus.qt.qtgui.graphic.QGraphicsTextBoxing.setDefaultTextColor">[docs]</a>    <span class="k">def</span> <span class="nf">setDefaultTextColor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="o">.</span><span class="n">setDefaultTextColor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span></div>

<div class="viewcode-block" id="QGraphicsTextBoxing.setHtml"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_QGraphicsTextBoxing.html#taurus.qt.qtgui.graphic.QGraphicsTextBoxing.setHtml">[docs]</a>    <span class="k">def</span> <span class="nf">setHtml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">html</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="o">.</span><span class="n">setHtml</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_invalidateLayout</span><span class="p">()</span></div>

<div class="viewcode-block" id="QGraphicsTextBoxing.setFont"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_QGraphicsTextBoxing.html#taurus.qt.qtgui.graphic.QGraphicsTextBoxing.setFont">[docs]</a>    <span class="k">def</span> <span class="nf">setFont</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">font</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">font</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_invalidateLayout</span><span class="p">()</span></div>

<div class="viewcode-block" id="QGraphicsTextBoxing.setAlignment"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_QGraphicsTextBoxing.html#taurus.qt.qtgui.graphic.QGraphicsTextBoxing.setAlignment">[docs]</a>    <span class="k">def</span> <span class="nf">setAlignment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alignment</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_alignment</span> <span class="o">=</span> <span class="n">alignment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_invalidateLayout</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">_invalidateLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Invalidate the current location of the text&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__layoutValide</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__layoutValide</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_validateLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compute the text location&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__layoutValide</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rect</span><span class="o">.</span><span class="n">rect</span><span class="p">()</span>
        <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">rect</span><span class="o">.</span><span class="n">width</span><span class="p">(),</span> <span class="n">rect</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
        <span class="n">textRect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span>

        <span class="c1"># horizontal layout</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">rect</span><span class="o">.</span><span class="n">x</span><span class="p">()</span>
        <span class="n">alignment</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_alignment</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">alignment</span> <span class="o">&amp;</span> <span class="nb">int</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignLeft</span><span class="p">))</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">+=</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">alignment</span> <span class="o">&amp;</span> <span class="nb">int</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignHCenter</span><span class="p">))</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">+=</span> <span class="n">width</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">-</span> <span class="n">textRect</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_TEXT_RATIO</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">alignment</span> <span class="o">&amp;</span> <span class="nb">int</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignRight</span><span class="p">))</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">+=</span> <span class="n">width</span> <span class="o">-</span> <span class="n">textRect</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_TEXT_RATIO</span>

        <span class="c1"># vertical layout</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">rect</span><span class="o">.</span><span class="n">y</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">alignment</span> <span class="o">&amp;</span> <span class="nb">int</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignTop</span><span class="p">))</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">+=</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">alignment</span> <span class="o">&amp;</span> <span class="nb">int</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignVCenter</span><span class="p">))</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">+=</span> <span class="n">height</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">-</span> <span class="n">textRect</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_TEXT_RATIO</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">alignment</span> <span class="o">&amp;</span> <span class="nb">int</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignBottom</span><span class="p">))</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">+=</span> <span class="n">height</span> <span class="o">-</span> <span class="n">textRect</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_TEXT_RATIO</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="o">.</span><span class="n">setPos</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__layoutValide</span> <span class="o">=</span> <span class="kc">True</span>

<div class="viewcode-block" id="QGraphicsTextBoxing.paint"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_QGraphicsTextBoxing.html#taurus.qt.qtgui.graphic.QGraphicsTextBoxing.paint">[docs]</a>    <span class="k">def</span> <span class="nf">paint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">painter</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">widget</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validateLayout</span><span class="p">()</span>
        <span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsItemGroup</span><span class="o">.</span><span class="n">paint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">painter</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">widget</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="QSpline"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_QSpline.html#taurus.qt.qtgui.graphic.QSpline">[docs]</a><span class="k">class</span> <span class="nc">QSpline</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsPathItem</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">control_points</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">QSpline</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__closed</span> <span class="o">=</span> <span class="n">closed</span>
        <span class="k">if</span> <span class="n">control_points</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">control_points</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setControlPoints</span><span class="p">(</span><span class="n">control_points</span><span class="p">)</span>

<div class="viewcode-block" id="QSpline.setControlPoints"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_QSpline.html#taurus.qt.qtgui.graphic.QSpline.setControlPoints">[docs]</a>    <span class="k">def</span> <span class="nf">setControlPoints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">control_points</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__control_points</span> <span class="o">=</span> <span class="n">control_points</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateSplinePath</span><span class="p">()</span></div>

<div class="viewcode-block" id="QSpline.setClose"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_QSpline.html#taurus.qt.qtgui.graphic.QSpline.setClose">[docs]</a>    <span class="k">def</span> <span class="nf">setClose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isClosed</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__closed</span> <span class="o">==</span> <span class="n">isClosed</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__closed</span> <span class="o">=</span> <span class="n">isClosed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateSplinePath</span><span class="p">()</span></div>

<div class="viewcode-block" id="QSpline.updateSplinePath"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_QSpline.html#taurus.qt.qtgui.graphic.QSpline.updateSplinePath">[docs]</a>    <span class="k">def</span> <span class="nf">updateSplinePath</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">QPainterPath</span><span class="p">()</span>
        <span class="n">cp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__control_points</span>
        <span class="n">nb_points</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nb_points</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="n">nb_points</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">path</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="n">cp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">path</span><span class="o">.</span><span class="n">lineTo</span><span class="p">(</span><span class="n">cp</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">path</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="n">cp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nb_points</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
                <span class="n">p1</span> <span class="o">=</span> <span class="n">cp</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">0</span><span class="p">]</span>
                <span class="n">p2</span> <span class="o">=</span> <span class="n">cp</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                <span class="n">end</span> <span class="o">=</span> <span class="n">cp</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span>
                <span class="n">path</span><span class="o">.</span><span class="n">cubicTo</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__closed</span><span class="p">:</span>
                <span class="n">path</span><span class="o">.</span><span class="n">lineTo</span><span class="p">(</span><span class="n">cp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setPath</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="TaurusGraphicsItem"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsItem.html#taurus.qt.qtgui.graphic.TaurusGraphicsItem">[docs]</a><span class="k">class</span> <span class="nc">TaurusGraphicsItem</span><span class="p">(</span><span class="n">TaurusBaseComponent</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for all Taurus Graphics Items&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">call__init__</span><span class="p">(</span><span class="n">TaurusBaseComponent</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
                          <span class="n">parent</span><span class="p">)</span>  <span class="c1"># &lt;- log created here</span>
        <span class="c1">#self.debug(&#39;TaurusGraphicsItem(%s,%s)&#39; % (name,parent))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ignoreRepaint</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_currFgBrush</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_currBgBrush</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_currText</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_currHtmlText</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_map</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_default</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_visible</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># self.getExtensions() &lt;= It must be called AFTER set_common_params()</span>
        <span class="c1"># in getGraphicsItem()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_contextMenu</span> <span class="o">=</span> <span class="p">[]</span>

<div class="viewcode-block" id="TaurusGraphicsItem.setName"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsItem.html#taurus.qt.qtgui.graphic.TaurusGraphicsItem.setName">[docs]</a>    <span class="k">def</span> <span class="nf">setName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="c1"># srubio@cells.es: modified to store ._name since initialization (even</span>
        <span class="c1"># if a model is not set)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span></div>

<div class="viewcode-block" id="TaurusGraphicsItem.getName"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsItem.html#taurus.qt.qtgui.graphic.TaurusGraphicsItem.getName">[docs]</a>    <span class="k">def</span> <span class="nf">getName</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span></div>

<div class="viewcode-block" id="TaurusGraphicsItem.setContextMenu"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsItem.html#taurus.qt.qtgui.graphic.TaurusGraphicsItem.setContextMenu">[docs]</a>    <span class="k">def</span> <span class="nf">setContextMenu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">menu</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Context Menu must be a list of tuples (ActionName,ActionMethod), empty tuples insert separators between options.&#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_contextMenu</span> <span class="o">=</span> <span class="n">menu</span></div>

<div class="viewcode-block" id="TaurusGraphicsItem.contextMenu"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsItem.html#taurus.qt.qtgui.graphic.TaurusGraphicsItem.contextMenu">[docs]</a>    <span class="k">def</span> <span class="nf">contextMenu</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contextMenu</span></div>

<div class="viewcode-block" id="TaurusGraphicsItem.getExtensions"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsItem.html#taurus.qt.qtgui.graphic.TaurusGraphicsItem.getExtensions">[docs]</a>    <span class="k">def</span> <span class="nf">getExtensions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Any in</span>
<span class="sd">        ExtensionsList,noPrompt,standAlone,noTooltip,noSelect,ignoreRepaint,shellCommand,className,classParams</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_extensions</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_extensions&#39;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="k">if</span> <span class="s1">&#39;ExtensionsList&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extensions</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_extensions</span><span class="o">.</span><span class="n">update</span><span class="p">((</span><span class="n">k</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extensions</span><span class="p">[</span>
                                    <span class="s1">&#39;ExtensionsList&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_extensions</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;ExtensionsList&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;noPrompt&#39;</span><span class="p">,</span> <span class="s1">&#39;standAlone&#39;</span><span class="p">,</span> <span class="s1">&#39;noTooltip&#39;</span><span class="p">,</span> <span class="s1">&#39;ignoreRepaint&#39;</span><span class="p">,</span> <span class="s1">&#39;noSelect&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extensions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_extensions</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">noPrompt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extensions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;noPrompt&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">standAlone</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extensions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;standAlone&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">noTooltip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extensions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;noTooltip&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ignoreRepaint</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extensions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="s1">&#39;ignoreRepaint&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignoreRepaint</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_extensions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="p">))</span>
        <span class="n">tooltip</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">noTooltip</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">==</span>
                         <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="p">)</span>
        <span class="c1">#self.debug(&#39;setting %s.tooltip = %s&#39;%(self._name,tooltip))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">tooltip</span><span class="p">)</span>
        <span class="c1">#self.debug(&#39;%s.getExtensions(): %s&#39;%(self._name,self._extensions))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extensions</span></div>

    <span class="c1">#-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-</span>
    <span class="c1"># Mandatory methods to be implemented in any subclass of TaurusComponent</span>
    <span class="c1">#-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-</span>

<div class="viewcode-block" id="TaurusGraphicsItem.setModel"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsItem.html#taurus.qt.qtgui.graphic.TaurusGraphicsItem.setModel">[docs]</a>    <span class="k">def</span> <span class="nf">setModel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
        <span class="c1">#self.debug(&#39;In %s.setModel(%s)&#39;%(type(self).__name__,model))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">Manager</span><span class="p">()</span><span class="o">.</span><span class="n">findObjectClass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="p">),</span> <span class="n">TaurusDevice</span><span class="p">):</span>
            <span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">+</span> <span class="s1">&#39;/state&#39;</span>
        <span class="n">TaurusBaseComponent</span><span class="o">.</span><span class="n">setModel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span></div>

<div class="viewcode-block" id="TaurusGraphicsItem.getParentTaurusComponent"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsItem.html#taurus.qt.qtgui.graphic.TaurusGraphicsItem.getParentTaurusComponent">[docs]</a>    <span class="k">def</span> <span class="nf">getParentTaurusComponent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns a parent Taurus component or None if no parent TaurusBaseComponent</span>
<span class="sd">            is found.&quot;&quot;&quot;</span>
        <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span>
        <span class="k">while</span> <span class="n">p</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">TaurusGraphicsItem</span><span class="p">):</span>
            <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">p</span></div>

    <span class="c1"># def fireEvent(self, type):</span>
<div class="viewcode-block" id="TaurusGraphicsItem.fireEvent"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsItem.html#taurus.qt.qtgui.graphic.TaurusGraphicsItem.fireEvent">[docs]</a>    <span class="k">def</span> <span class="nf">fireEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evt_src</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">evt_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">evt_value</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;fires a value changed event to all listeners&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateStyle</span><span class="p">()</span></div>

<div class="viewcode-block" id="TaurusGraphicsItem.updateStyle"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsItem.html#taurus.qt.qtgui.graphic.TaurusGraphicsItem.updateStyle">[docs]</a>    <span class="k">def</span> <span class="nf">updateStyle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method called when the component detects an event that triggers a change</span>
<span class="sd">            in the style.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">updateSceneItem</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

    <span class="c1"># getDisplayValue is already (and better) implemented in TaurusBaseComponent</span>
    <span class="c1"># def getDisplayValue(self):</span>
        <span class="c1">#attrvalue = self.getModelValueObj()</span>
        <span class="c1"># if not attrvalue:</span>
            <span class="c1"># return self.getNoneValue()</span>
        <span class="c1"># return str(attrvalue.value)</span>

<div class="viewcode-block" id="TaurusGraphicsItem.isReadOnly"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsItem.html#taurus.qt.qtgui.graphic.TaurusGraphicsItem.isReadOnly">[docs]</a>    <span class="k">def</span> <span class="nf">isReadOnly</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span></div>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_name</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">modelName</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>

<div class="viewcode-block" id="TaurusGraphicsItem.getModelClass"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsItem.html#taurus.qt.qtgui.graphic.TaurusGraphicsItem.getModelClass">[docs]</a>    <span class="k">def</span> <span class="nf">getModelClass</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">TaurusAttribute</span></div></div>


<div class="viewcode-block" id="TaurusGraphicsAttributeItem"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsAttributeItem.html#taurus.qt.qtgui.graphic.TaurusGraphicsAttributeItem">[docs]</a><span class="k">class</span> <span class="nc">TaurusGraphicsAttributeItem</span><span class="p">(</span><span class="n">TaurusGraphicsItem</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class show value-&gt;text conversion in label widgets.</span>
<span class="sd">    Quality is shown in background</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unitVisible</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_currValue</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_userFormat</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unitVisible</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">call__init__</span><span class="p">(</span><span class="n">TaurusGraphicsItem</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>

    <span class="nd">@deprecation_decorator</span><span class="p">(</span><span class="n">alt</span><span class="o">=</span><span class="s2">&quot;.getDisplayValue(fragmentName=&#39;rvalue.units&#39;)&quot;</span><span class="p">,</span>
                           <span class="n">rel</span><span class="o">=</span><span class="s2">&quot;4.0.3&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">getUnit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDisplayValue</span><span class="p">(</span><span class="n">fragmentName</span><span class="o">=</span><span class="s1">&#39;rvalue.units&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="TaurusGraphicsAttributeItem.updateStyle"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsAttributeItem.html#taurus.qt.qtgui.graphic.TaurusGraphicsAttributeItem.updateStyle">[docs]</a>    <span class="k">def</span> <span class="nf">updateStyle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getModelValueObj</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getShowQuality</span><span class="p">():</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">quality</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
                    <span class="n">quality</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">quality</span>
                <span class="k">if</span> <span class="n">quality</span> <span class="o">==</span> <span class="n">AttrQuality</span><span class="o">.</span><span class="n">ATTR_VALID</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validBackground</span><span class="p">:</span>
                    <span class="n">background</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validBackground</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">background</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">QT_ATTRIBUTE_QUALITY_PALETTE</span><span class="o">.</span><span class="n">qcolor</span><span class="p">(</span>
                        <span class="n">quality</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">QBrush</span><span class="p">(</span><span class="n">background</span><span class="p">))</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;In TaurusGraphicsAttributeItem(</span><span class="si">%s</span><span class="s1">).updateStyle(</span><span class="si">%s</span><span class="s1">): colors failed!&#39;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_currText</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">v</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_userFormat</span><span class="p">:</span>
            <span class="c1"># TODO: consider extending this to use newer pyhon formatting syntax</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">rvalue</span><span class="p">,</span> <span class="s1">&#39;magnitude&#39;</span><span class="p">):</span>
                <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_userFormat</span> <span class="o">%</span> <span class="n">v</span><span class="o">.</span><span class="n">rvalue</span><span class="o">.</span><span class="n">magnitude</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_userFormat</span> <span class="o">%</span> <span class="n">v</span><span class="o">.</span><span class="n">rvalue</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unitVisible</span><span class="p">:</span>
                <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2"> {1.rvalue.units:~s}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unitVisible</span><span class="p">:</span>
                <span class="n">_frName</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">_frName</span> <span class="o">=</span> <span class="s1">&#39;rvalue.magnitude&#39;</span>
            <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_currText</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDisplayValue</span><span class="p">(</span><span class="n">fragmentName</span><span class="o">=</span><span class="n">_frName</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_currText</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;unicode-escape&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_currHtmlText</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">TaurusGraphicsItem</span><span class="o">.</span><span class="n">updateStyle</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="TaurusGraphicsAttributeItem.setUserFormat"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsAttributeItem.html#taurus.qt.qtgui.graphic.TaurusGraphicsAttributeItem.setUserFormat">[docs]</a>    <span class="k">def</span> <span class="nf">setUserFormat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">format</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_userFormat</span> <span class="o">=</span> <span class="nb">format</span></div>

<div class="viewcode-block" id="TaurusGraphicsAttributeItem.setUnitVisible"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsAttributeItem.html#taurus.qt.qtgui.graphic.TaurusGraphicsAttributeItem.setUnitVisible">[docs]</a>    <span class="k">def</span> <span class="nf">setUnitVisible</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">yesno</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unitVisible</span> <span class="o">=</span> <span class="n">yesno</span></div></div>


<div class="viewcode-block" id="TaurusGraphicsStateItem"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsStateItem.html#taurus.qt.qtgui.graphic.TaurusGraphicsStateItem">[docs]</a><span class="k">class</span> <span class="nc">TaurusGraphicsStateItem</span><span class="p">(</span><span class="n">TaurusGraphicsItem</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    In State Item the displayValue should not override the label</span>
<span class="sd">    This item will modify only foreground/background colors</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">call__init__</span><span class="p">(</span><span class="n">TaurusGraphicsItem</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>

<div class="viewcode-block" id="TaurusGraphicsStateItem.updateStyle"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGraphicsStateItem.html#taurus.qt.qtgui.graphic.TaurusGraphicsStateItem.updateStyle">[docs]</a>    <span class="k">def</span> <span class="nf">updateStyle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getModelValueObj</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_currBrush</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">QBrush</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoBrush</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">v</span><span class="p">:</span>  <span class="c1"># or self.getShowState():</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">bg_brush</span><span class="p">,</span> <span class="n">fg_brush</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getModelObj</span><span class="p">()</span><span class="o">.</span><span class="n">getType</span><span class="p">()</span> <span class="o">==</span> <span class="n">DataType</span><span class="o">.</span><span class="n">DevState</span><span class="p">:</span>
                    <span class="n">bg_brush</span><span class="p">,</span> <span class="n">fg_brush</span> <span class="o">=</span> <span class="n">QT_DEVICE_STATE_PALETTE</span><span class="o">.</span><span class="n">qbrush</span><span class="p">(</span>
                        <span class="n">v</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">getModelObj</span><span class="p">()</span><span class="o">.</span><span class="n">getType</span><span class="p">()</span> <span class="o">==</span> <span class="n">DataType</span><span class="o">.</span><span class="n">Boolean</span><span class="p">:</span>
                    <span class="n">bg_brush</span><span class="p">,</span> <span class="n">fg_brush</span> <span class="o">=</span> <span class="n">QT_DEVICE_STATE_PALETTE</span><span class="o">.</span><span class="n">qbrush</span><span class="p">(</span>
                        <span class="p">(</span><span class="n">DevState</span><span class="o">.</span><span class="n">FAULT</span><span class="p">,</span> <span class="n">DevState</span><span class="o">.</span><span class="n">ON</span><span class="p">)[</span><span class="n">v</span><span class="o">.</span><span class="n">value</span><span class="p">])</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">getShowQuality</span><span class="p">():</span>
                    <span class="n">bg_brush</span><span class="p">,</span> <span class="n">fg_brush</span> <span class="o">=</span> <span class="n">QT_ATTRIBUTE_QUALITY_PALETTE</span><span class="o">.</span><span class="n">qbrush</span><span class="p">(</span>
                        <span class="n">v</span><span class="o">.</span><span class="n">quality</span><span class="p">)</span>
                <span class="k">if</span> <span class="kc">None</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">bg_brush</span><span class="p">,</span> <span class="n">fg_brush</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_currBgBrush</span> <span class="o">=</span> <span class="n">bg_brush</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_currFgBrush</span> <span class="o">=</span> <span class="n">fg_brush</span>
                    <span class="c1"># If there&#39;s no filling, applying background brush to</span>
                    <span class="c1"># foreground</span>
                    <span class="k">if</span> <span class="n">Qt</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoBrush</span> <span class="o">!=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_fillStyle&#39;</span><span class="p">,</span> <span class="n">Qt</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoBrush</span><span class="p">):</span>
                        <span class="c1">#self.debug(&#39;In TaurusGraphicsStateItem(%s).updateStyle(%s): switching background to foreground&#39;%(self._name,self._currText))</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_currFgBrush</span> <span class="o">=</span> <span class="n">bg_brush</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_currText</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_currHtmlText</span> <span class="o">=</span> <span class="s1">&#39;&lt;p style=&quot;color:</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/p&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_currBgBrush</span><span class="o">.</span><span class="n">color</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_currText</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;In TaurusGraphicsStateItem(</span><span class="si">%s</span><span class="s1">).updateStyle(</span><span class="si">%s</span><span class="s1">): colors failed!&#39;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_currText</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>

        <span class="c1"># Parsing _map to manage visibility (a list of values for which the</span>
        <span class="c1"># item is visible or not)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">v</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_map</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_currText</span> <span class="ow">in</span> <span class="n">DevState</span><span class="o">.</span><span class="n">__members__</span><span class="p">):</span>
            <span class="c1">#self.debug(&#39;In TaurusGraphicsStateItem.updateStyle(): mapping %s&#39;%self._currText)</span>
            <span class="k">if</span> <span class="n">DevState</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_currText</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_map</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_map</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_visible</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_map</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_default</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_visible</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default</span>

        <span class="n">TaurusGraphicsItem</span><span class="o">.</span><span class="n">updateStyle</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="TaurusEllipseStateItem"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusEllipseStateItem.html#taurus.qt.qtgui.graphic.TaurusEllipseStateItem">[docs]</a><span class="k">class</span> <span class="nc">TaurusEllipseStateItem</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsEllipseItem</span><span class="p">,</span> <span class="n">TaurusGraphicsStateItem</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scene</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsEllipseItem</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">scene</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">call__init__</span><span class="p">(</span><span class="n">TaurusGraphicsStateItem</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>

<div class="viewcode-block" id="TaurusEllipseStateItem.paint"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusEllipseStateItem.html#taurus.qt.qtgui.graphic.TaurusEllipseStateItem.paint">[docs]</a>    <span class="k">def</span> <span class="nf">paint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">painter</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">widget</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_currBgBrush</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_currBgBrush</span><span class="o">.</span><span class="n">setStyle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">brush</span><span class="p">()</span><span class="o">.</span><span class="n">style</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_currBgBrush</span><span class="p">)</span>
        <span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsEllipseItem</span><span class="o">.</span><span class="n">paint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">painter</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">widget</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="TaurusRectStateItem"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusRectStateItem.html#taurus.qt.qtgui.graphic.TaurusRectStateItem">[docs]</a><span class="k">class</span> <span class="nc">TaurusRectStateItem</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsRectItem</span><span class="p">,</span> <span class="n">TaurusGraphicsStateItem</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scene</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsRectItem</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">scene</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">call__init__</span><span class="p">(</span><span class="n">TaurusGraphicsStateItem</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>

<div class="viewcode-block" id="TaurusRectStateItem.paint"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusRectStateItem.html#taurus.qt.qtgui.graphic.TaurusRectStateItem.paint">[docs]</a>    <span class="k">def</span> <span class="nf">paint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">painter</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">widget</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_currBgBrush</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_currBgBrush</span><span class="o">.</span><span class="n">setStyle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">brush</span><span class="p">()</span><span class="o">.</span><span class="n">style</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_currBgBrush</span><span class="p">)</span>
        <span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsRectItem</span><span class="o">.</span><span class="n">paint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">painter</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">widget</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="TaurusSplineStateItem"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusSplineStateItem.html#taurus.qt.qtgui.graphic.TaurusSplineStateItem">[docs]</a><span class="k">class</span> <span class="nc">TaurusSplineStateItem</span><span class="p">(</span><span class="n">QSpline</span><span class="p">,</span> <span class="n">TaurusGraphicsStateItem</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scene</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="n">QSpline</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">scene</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">call__init__</span><span class="p">(</span><span class="n">TaurusGraphicsStateItem</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>

<div class="viewcode-block" id="TaurusSplineStateItem.paint"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusSplineStateItem.html#taurus.qt.qtgui.graphic.TaurusSplineStateItem.paint">[docs]</a>    <span class="k">def</span> <span class="nf">paint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">painter</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">widget</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_currBgBrush</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_currBgBrush</span><span class="o">.</span><span class="n">setStyle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">brush</span><span class="p">()</span><span class="o">.</span><span class="n">style</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_currBgBrush</span><span class="p">)</span>
        <span class="n">QSpline</span><span class="o">.</span><span class="n">paint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">painter</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">widget</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="TaurusRoundRectItem"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusRoundRectItem.html#taurus.qt.qtgui.graphic.TaurusRoundRectItem">[docs]</a><span class="k">class</span> <span class="nc">TaurusRoundRectItem</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsPathItem</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scene</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsPathItem</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">scene</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__rect</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setCornerWidth</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__updatePath</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__rect</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__corner</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">QPainterPath</span><span class="p">()</span>
        <span class="n">cornerWidth</span><span class="p">,</span> <span class="n">nbPoints</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__corner</span>
        <span class="k">if</span> <span class="n">cornerWidth</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">nbPoints</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">path</span><span class="o">.</span><span class="n">addRect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__rect</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">cornerWidth</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">__rect</span><span class="o">.</span><span class="n">width</span><span class="p">():</span>
            <span class="n">path</span><span class="o">.</span><span class="n">addRect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__rect</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">cornerWidth</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">__rect</span><span class="o">.</span><span class="n">height</span><span class="p">():</span>
            <span class="n">path</span><span class="o">.</span><span class="n">addRect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__rect</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">path</span><span class="o">.</span><span class="n">addRoundedRect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__rect</span><span class="p">,</span> <span class="n">cornerWidth</span><span class="p">,</span> <span class="n">cornerWidth</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setPath</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

<div class="viewcode-block" id="TaurusRoundRectItem.setRect"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusRoundRectItem.html#taurus.qt.qtgui.graphic.TaurusRoundRectItem.setRect">[docs]</a>    <span class="k">def</span> <span class="nf">setRect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__rect</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">QRectF</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__updatePath</span><span class="p">()</span></div>

<div class="viewcode-block" id="TaurusRoundRectItem.setCornerWidth"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusRoundRectItem.html#taurus.qt.qtgui.graphic.TaurusRoundRectItem.setCornerWidth">[docs]</a>    <span class="k">def</span> <span class="nf">setCornerWidth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">nbPoints</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__corner</span> <span class="o">=</span> <span class="n">width</span><span class="p">,</span> <span class="n">nbPoints</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__updatePath</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="TaurusRoundRectStateItem"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusRoundRectStateItem.html#taurus.qt.qtgui.graphic.TaurusRoundRectStateItem">[docs]</a><span class="k">class</span> <span class="nc">TaurusRoundRectStateItem</span><span class="p">(</span><span class="n">TaurusRoundRectItem</span><span class="p">,</span> <span class="n">TaurusGraphicsStateItem</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scene</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="n">TaurusRoundRectItem</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">scene</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">call__init__</span><span class="p">(</span><span class="n">TaurusGraphicsStateItem</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>

<div class="viewcode-block" id="TaurusRoundRectStateItem.paint"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusRoundRectStateItem.html#taurus.qt.qtgui.graphic.TaurusRoundRectStateItem.paint">[docs]</a>    <span class="k">def</span> <span class="nf">paint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">painter</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">widget</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_currBgBrush</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_currBgBrush</span><span class="o">.</span><span class="n">setStyle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">brush</span><span class="p">()</span><span class="o">.</span><span class="n">style</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_currBgBrush</span><span class="p">)</span>
        <span class="n">TaurusRoundRectItem</span><span class="o">.</span><span class="n">paint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">painter</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">widget</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="TaurusGroupItem"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGroupItem.html#taurus.qt.qtgui.graphic.TaurusGroupItem">[docs]</a><span class="k">class</span> <span class="nc">TaurusGroupItem</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsItemGroup</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scene</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsItemGroup</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">scene</span><span class="p">)</span></div>


<div class="viewcode-block" id="TaurusGroupStateItem"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGroupStateItem.html#taurus.qt.qtgui.graphic.TaurusGroupStateItem">[docs]</a><span class="k">class</span> <span class="nc">TaurusGroupStateItem</span><span class="p">(</span><span class="n">TaurusGroupItem</span><span class="p">,</span> <span class="n">TaurusGraphicsStateItem</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scene</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="n">TaurusGroupItem</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">scene</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">call__init__</span><span class="p">(</span><span class="n">TaurusGraphicsStateItem</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>

<div class="viewcode-block" id="TaurusGroupStateItem.paint"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusGroupStateItem.html#taurus.qt.qtgui.graphic.TaurusGroupStateItem.paint">[docs]</a>    <span class="k">def</span> <span class="nf">paint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">painter</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">widget</span><span class="p">):</span>
        <span class="n">TaurusGroupItem</span><span class="o">.</span><span class="n">paint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">painter</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">widget</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="TaurusPolygonStateItem"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusPolygonStateItem.html#taurus.qt.qtgui.graphic.TaurusPolygonStateItem">[docs]</a><span class="k">class</span> <span class="nc">TaurusPolygonStateItem</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsPolygonItem</span><span class="p">,</span> <span class="n">TaurusGraphicsStateItem</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scene</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="c1">#Qt.QGraphicsRectItem.__init__(self, parent, scene)</span>
        <span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsPolygonItem</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">scene</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">call__init__</span><span class="p">(</span><span class="n">TaurusGraphicsStateItem</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>

<div class="viewcode-block" id="TaurusPolygonStateItem.paint"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusPolygonStateItem.html#taurus.qt.qtgui.graphic.TaurusPolygonStateItem.paint">[docs]</a>    <span class="k">def</span> <span class="nf">paint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">painter</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">widget</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_currBgBrush</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_currBgBrush</span><span class="o">.</span><span class="n">setStyle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">brush</span><span class="p">()</span><span class="o">.</span><span class="n">style</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_currBgBrush</span><span class="p">)</span>
        <span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsPolygonItem</span><span class="o">.</span><span class="n">paint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">painter</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">widget</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="TaurusLineStateItem"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusLineStateItem.html#taurus.qt.qtgui.graphic.TaurusLineStateItem">[docs]</a><span class="k">class</span> <span class="nc">TaurusLineStateItem</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsLineItem</span><span class="p">,</span> <span class="n">TaurusGraphicsStateItem</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scene</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsLineItem</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">scene</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">call__init__</span><span class="p">(</span><span class="n">TaurusGraphicsStateItem</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>

<div class="viewcode-block" id="TaurusLineStateItem.paint"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusLineStateItem.html#taurus.qt.qtgui.graphic.TaurusLineStateItem.paint">[docs]</a>    <span class="k">def</span> <span class="nf">paint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">painter</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">widget</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_currBgBrush</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_currBgBrush</span><span class="o">.</span><span class="n">setStyle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">brush</span><span class="p">()</span><span class="o">.</span><span class="n">style</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_currBgBrush</span><span class="p">)</span>
        <span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsLineItem</span><span class="o">.</span><span class="n">paint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">painter</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">widget</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="TaurusTextStateItem"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusTextStateItem.html#taurus.qt.qtgui.graphic.TaurusTextStateItem">[docs]</a><span class="k">class</span> <span class="nc">TaurusTextStateItem</span><span class="p">(</span><span class="n">QGraphicsTextBoxing</span><span class="p">,</span> <span class="n">TaurusGraphicsStateItem</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A QGraphicsItem that represents a text related to a device state or attribute quality</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scene</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="n">QGraphicsTextBoxing</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">scene</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">call__init__</span><span class="p">(</span><span class="n">TaurusGraphicsStateItem</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>

<div class="viewcode-block" id="TaurusTextStateItem.paint"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusTextStateItem.html#taurus.qt.qtgui.graphic.TaurusTextStateItem.paint">[docs]</a>    <span class="k">def</span> <span class="nf">paint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">painter</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">widget</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_currHtmlText</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setHtml</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_currHtmlText</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setPlainText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_currText</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">QGraphicsTextBoxing</span><span class="o">.</span><span class="n">paint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">painter</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">widget</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="TaurusTextAttributeItem"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusTextAttributeItem.html#taurus.qt.qtgui.graphic.TaurusTextAttributeItem">[docs]</a><span class="k">class</span> <span class="nc">TaurusTextAttributeItem</span><span class="p">(</span><span class="n">QGraphicsTextBoxing</span><span class="p">,</span> <span class="n">TaurusGraphicsAttributeItem</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A QGraphicsItem that represents a text related to an attribute value</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scene</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="n">QGraphicsTextBoxing</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">scene</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">call__init__</span><span class="p">(</span><span class="n">TaurusGraphicsAttributeItem</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>

<div class="viewcode-block" id="TaurusTextAttributeItem.paint"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusTextAttributeItem.html#taurus.qt.qtgui.graphic.TaurusTextAttributeItem.paint">[docs]</a>    <span class="k">def</span> <span class="nf">paint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">painter</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">widget</span><span class="p">):</span>
        <span class="c1"># self.debug(&#39;TaurusTextAttributeItem(%s,%s,%s)&#39;%(self.getName(),self._currText,self._currHtmlText))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_currHtmlText</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setHtml</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_currHtmlText</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setPlainText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_currText</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">QGraphicsTextBoxing</span><span class="o">.</span><span class="n">paint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">painter</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">widget</span><span class="p">)</span></div></div>


<span class="n">TYPE_TO_GRAPHICS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="kc">None</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;Rectangle&quot;</span><span class="p">:</span> <span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsRectItem</span><span class="p">,</span>
           <span class="s2">&quot;RoundRectangle&quot;</span><span class="p">:</span> <span class="n">TaurusRoundRectItem</span><span class="p">,</span>
           <span class="s2">&quot;Ellipse&quot;</span><span class="p">:</span> <span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsEllipseItem</span><span class="p">,</span>
           <span class="s2">&quot;Polyline&quot;</span><span class="p">:</span> <span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsPolygonItem</span><span class="p">,</span>
           <span class="s2">&quot;Label&quot;</span><span class="p">:</span> <span class="n">QGraphicsTextBoxing</span><span class="p">,</span>
           <span class="s2">&quot;Line&quot;</span><span class="p">:</span> <span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsLineItem</span><span class="p">,</span>
           <span class="s2">&quot;Group&quot;</span><span class="p">:</span> <span class="n">TaurusGroupItem</span><span class="p">,</span>
           <span class="s2">&quot;SwingObject&quot;</span><span class="p">:</span> <span class="n">TaurusTextAttributeItem</span><span class="p">,</span>
           <span class="s2">&quot;Image&quot;</span><span class="p">:</span> <span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsPixmapItem</span><span class="p">,</span>
           <span class="s2">&quot;Spline&quot;</span><span class="p">:</span> <span class="n">QSpline</span><span class="p">,</span> <span class="p">},</span>

    <span class="n">TaurusDevice</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;Rectangle&quot;</span><span class="p">:</span> <span class="n">TaurusRectStateItem</span><span class="p">,</span>
                   <span class="s2">&quot;RoundRectangle&quot;</span><span class="p">:</span> <span class="n">TaurusRoundRectStateItem</span><span class="p">,</span>
                   <span class="s2">&quot;Ellipse&quot;</span><span class="p">:</span> <span class="n">TaurusEllipseStateItem</span><span class="p">,</span>
                   <span class="s2">&quot;Polyline&quot;</span><span class="p">:</span> <span class="n">TaurusPolygonStateItem</span><span class="p">,</span>
                   <span class="s2">&quot;Label&quot;</span><span class="p">:</span> <span class="n">TaurusTextStateItem</span><span class="p">,</span>
                   <span class="s2">&quot;Line&quot;</span><span class="p">:</span> <span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsLineItem</span><span class="p">,</span>  <span class="c1"># TaurusLineStateItem,</span>
                   <span class="s2">&quot;Group&quot;</span><span class="p">:</span> <span class="n">TaurusGroupStateItem</span><span class="p">,</span>
                   <span class="s2">&quot;SwingObject&quot;</span><span class="p">:</span> <span class="n">TaurusTextAttributeItem</span><span class="p">,</span>
                   <span class="s2">&quot;Image&quot;</span><span class="p">:</span> <span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsPixmapItem</span><span class="p">,</span>
                   <span class="s2">&quot;Spline&quot;</span><span class="p">:</span> <span class="n">TaurusSplineStateItem</span><span class="p">,</span> <span class="p">},</span>

    <span class="n">TaurusAttribute</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;Rectangle&quot;</span><span class="p">:</span> <span class="n">TaurusRectStateItem</span><span class="p">,</span>
                      <span class="s2">&quot;RoundRectangle&quot;</span><span class="p">:</span> <span class="n">TaurusRoundRectStateItem</span><span class="p">,</span>
                      <span class="s2">&quot;Ellipse&quot;</span><span class="p">:</span> <span class="n">TaurusEllipseStateItem</span><span class="p">,</span>
                      <span class="s2">&quot;Polyline&quot;</span><span class="p">:</span> <span class="n">TaurusPolygonStateItem</span><span class="p">,</span>
                      <span class="s2">&quot;Label&quot;</span><span class="p">:</span> <span class="n">TaurusTextAttributeItem</span><span class="p">,</span>
                      <span class="s2">&quot;Line&quot;</span><span class="p">:</span> <span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsLineItem</span><span class="p">,</span>  <span class="c1"># TaurusLineStateItem,</span>
                      <span class="s2">&quot;Group&quot;</span><span class="p">:</span> <span class="n">TaurusGroupStateItem</span><span class="p">,</span>
                      <span class="s2">&quot;SwingObject&quot;</span><span class="p">:</span> <span class="n">TaurusTextAttributeItem</span><span class="p">,</span>
                      <span class="s2">&quot;Image&quot;</span><span class="p">:</span> <span class="n">Qt</span><span class="o">.</span><span class="n">QGraphicsPixmapItem</span><span class="p">,</span>
                      <span class="s2">&quot;Spline&quot;</span><span class="p">:</span> <span class="n">TaurusSplineStateItem</span><span class="p">,</span> <span class="p">},</span>
<span class="p">}</span>


<div class="viewcode-block" id="TaurusBaseGraphicsFactory"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusBaseGraphicsFactory.html#taurus.qt.qtgui.graphic.TaurusBaseGraphicsFactory">[docs]</a><span class="k">class</span> <span class="nc">TaurusBaseGraphicsFactory</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

<div class="viewcode-block" id="TaurusBaseGraphicsFactory.getSceneObj"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusBaseGraphicsFactory.html#taurus.qt.qtgui.graphic.TaurusBaseGraphicsFactory.getSceneObj">[docs]</a>    <span class="k">def</span> <span class="nf">getSceneObj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="s2">&quot;Invalid call to AbstractGraphicsFactory::getSceneObj()&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TaurusBaseGraphicsFactory.getObj"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusBaseGraphicsFactory.html#taurus.qt.qtgui.graphic.TaurusBaseGraphicsFactory.getObj">[docs]</a>    <span class="k">def</span> <span class="nf">getObj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Invalid call to AbstractGraphicsFactory::getObj()&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TaurusBaseGraphicsFactory.getRectangleObj"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusBaseGraphicsFactory.html#taurus.qt.qtgui.graphic.TaurusBaseGraphicsFactory.getRectangleObj">[docs]</a>    <span class="k">def</span> <span class="nf">getRectangleObj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="s2">&quot;Invalid call to AbstractGraphicsFactory::getRectangleObj()&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TaurusBaseGraphicsFactory.getRoundRectangleObj"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusBaseGraphicsFactory.html#taurus.qt.qtgui.graphic.TaurusBaseGraphicsFactory.getRoundRectangleObj">[docs]</a>    <span class="k">def</span> <span class="nf">getRoundRectangleObj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="s2">&quot;Invalid call to AbstractGraphicsFactory::getRoundRectangleObj()&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TaurusBaseGraphicsFactory.getLineObj"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusBaseGraphicsFactory.html#taurus.qt.qtgui.graphic.TaurusBaseGraphicsFactory.getLineObj">[docs]</a>    <span class="k">def</span> <span class="nf">getLineObj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="s2">&quot;Invalid call to AbstractGraphicsFactory::getLineObj()&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TaurusBaseGraphicsFactory.getEllipseObj"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusBaseGraphicsFactory.html#taurus.qt.qtgui.graphic.TaurusBaseGraphicsFactory.getEllipseObj">[docs]</a>    <span class="k">def</span> <span class="nf">getEllipseObj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="s2">&quot;Invalid call to AbstractGraphicsFactory::getEllipseObj()&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TaurusBaseGraphicsFactory.getPolylineObj"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusBaseGraphicsFactory.html#taurus.qt.qtgui.graphic.TaurusBaseGraphicsFactory.getPolylineObj">[docs]</a>    <span class="k">def</span> <span class="nf">getPolylineObj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="s2">&quot;Invalid call to AbstractGraphicsFactory::getPolylineObj()&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TaurusBaseGraphicsFactory.getLabelObj"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusBaseGraphicsFactory.html#taurus.qt.qtgui.graphic.TaurusBaseGraphicsFactory.getLabelObj">[docs]</a>    <span class="k">def</span> <span class="nf">getLabelObj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="s2">&quot;Invalid call to AbstractGraphicsFactory::getLabelObj()&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TaurusBaseGraphicsFactory.getGroupObj"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusBaseGraphicsFactory.html#taurus.qt.qtgui.graphic.TaurusBaseGraphicsFactory.getGroupObj">[docs]</a>    <span class="k">def</span> <span class="nf">getGroupObj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="s2">&quot;Invalid call to AbstractGraphicsFactory::getGroupObj()&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TaurusBaseGraphicsFactory.getSwingObjectObj"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusBaseGraphicsFactory.html#taurus.qt.qtgui.graphic.TaurusBaseGraphicsFactory.getSwingObjectObj">[docs]</a>    <span class="k">def</span> <span class="nf">getSwingObjectObj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="s2">&quot;Invalid call to AbstractGraphicsFactory::getSwingObjectObj()&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TaurusBaseGraphicsFactory.getImageObj"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusBaseGraphicsFactory.html#taurus.qt.qtgui.graphic.TaurusBaseGraphicsFactory.getImageObj">[docs]</a>    <span class="k">def</span> <span class="nf">getImageObj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parms</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="s2">&quot;Invalid call to AbstractGraphicsFactory::getImageObj()&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TaurusBaseGraphicsFactory.getSplineObj"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusBaseGraphicsFactory.html#taurus.qt.qtgui.graphic.TaurusBaseGraphicsFactory.getSplineObj">[docs]</a>    <span class="k">def</span> <span class="nf">getSplineObj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="s2">&quot;Invalid call to AbstractGraphicsFactory::getSplineObj()&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TaurusBaseGraphicsFactory.getGraphicsClassItem"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusBaseGraphicsFactory.html#taurus.qt.qtgui.graphic.TaurusBaseGraphicsFactory.getGraphicsClassItem">[docs]</a>    <span class="k">def</span> <span class="nf">getGraphicsClassItem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="n">type_</span><span class="p">):</span>
        <span class="n">ncls</span> <span class="o">=</span> <span class="bp">cls</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">issubclass</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">TaurusDevice</span><span class="p">):</span>
                <span class="n">ncls</span> <span class="o">=</span> <span class="n">TaurusDevice</span>
            <span class="k">elif</span> <span class="nb">issubclass</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">TaurusAttribute</span><span class="p">):</span>
                <span class="n">ncls</span> <span class="o">=</span> <span class="n">TaurusAttribute</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="n">ncls</span> <span class="o">=</span> <span class="n">TYPE_TO_GRAPHICS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="n">ncls</span><span class="p">,</span> <span class="n">TYPE_TO_GRAPHICS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">type_</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ncls</span></div>

<div class="viewcode-block" id="TaurusBaseGraphicsFactory.getGraphicsItem"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusBaseGraphicsFactory.html#taurus.qt.qtgui.graphic.TaurusBaseGraphicsFactory.getGraphicsItem">[docs]</a>    <span class="k">def</span> <span class="nf">getGraphicsItem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">type_</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getNameParam</span><span class="p">())</span>
        <span class="c1"># applying alias</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;alias&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
                <span class="n">params</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">getNameParam</span><span class="p">()]</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">cls</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="s1">&#39;/&#39;</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
            <span class="c1"># replacing Taco identifiers in %s&#39;%name</span>
            <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;tango:&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">or</span> <span class="ow">not</span> <span class="s1">&#39;tango:/&#39;</span> <span class="ow">in</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()):</span>
                <span class="n">nname</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">params</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">getNameParam</span><span class="p">()]</span> <span class="o">=</span> <span class="n">name</span> <span class="o">=</span> <span class="n">nname</span>
            <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;/state&#39;</span><span class="p">):</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">cls</span> <span class="o">=</span> <span class="n">Manager</span><span class="p">()</span><span class="o">.</span><span class="n">findObjectClass</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">name</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> does not match a tango name&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">klass</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getGraphicsClassItem</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">type_</span><span class="p">)</span>
        <span class="n">item</span> <span class="o">=</span> <span class="n">klass</span><span class="p">()</span>
        <span class="c1"># It&#39;s here were Attributes are subscribed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_common_params</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="s1">&#39;getExtensions&#39;</span><span class="p">):</span>
            <span class="n">item</span><span class="o">.</span><span class="n">getExtensions</span><span class="p">()</span>  <span class="c1"># &lt;= must be called here to take extensions from params</span>
        <span class="k">return</span> <span class="n">item</span></div>

<div class="viewcode-block" id="TaurusBaseGraphicsFactory.getNameParam"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusBaseGraphicsFactory.html#taurus.qt.qtgui.graphic.TaurusBaseGraphicsFactory.getNameParam">[docs]</a>    <span class="k">def</span> <span class="nf">getNameParam</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the name of the parameter which contains the name identifier.</span>
<span class="sd">           Default implementation returns &#39;name&#39;.</span>
<span class="sd">           Overwrite has necessary.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s1">&#39;name&#39;</span></div>

<div class="viewcode-block" id="TaurusBaseGraphicsFactory.set_common_params"><a class="viewcode-back" href="../../../../../devel/api/taurus/qt/qtgui/graphic/_TaurusBaseGraphicsFactory.html#taurus.qt.qtgui.graphic.TaurusBaseGraphicsFactory.set_common_params">[docs]</a>    <span class="k">def</span> <span class="nf">set_common_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the common parameters. Default implementation does nothing.</span>
<span class="sd">           Overwrite has necessary.&quot;&quot;&quot;</span>
        <span class="k">pass</span></div></div>
</pre></div>

           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Except where otherwise noted, content on this site is
licensed under a Creative Commons Attribution 3.0 License.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../../../',
            VERSION:'4.1.2-alpha',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>