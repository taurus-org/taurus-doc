

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>taurus.core.evaluation &mdash; taurus 3.12.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../../search.html"/>
    <link rel="top" title="taurus 3.12.0 documentation" href="../../../../index.html"/>
        <link rel="up" title="taurus.core" href="../core.html"/>
        <link rel="next" title="EvaluationAttribute" href="evaluation/_EvaluationAttribute.html"/>
        <link rel="prev" title="EpicsFactory" href="epics/_EpicsFactory.html"/> 

  
  <script src="../../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../../index.html" class="icon icon-home"> taurus
          

          
            
            <img src="../../../../_static/taurus.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                3.12
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference external" href="http://www.taurus-scada.org">Home Page</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/taurus-org/taurus">Project Page</a></li>
<li class="toctree-l1"><a class="reference external" href="http://pypi.python.org/pypi/taurus">Download from PyPI</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../../docs.html">Taurus 3.12 documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../../users/index.html">User&#8217;s Guide</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../index.html">Developer&#8217;s Guide</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../../tau2taurus_migration_guide.html">tau to taurus migration guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../coding_guide.html">Development guidelines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../color_guide.html">Color guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../icon_guide.html">Icon guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../designer_tutorial.html">Designer tutorial</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../core_tutorial.html">Core tutorial</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../widget_tutorial.html">Widget tutorial</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../popupmenu_tutorial.html">Popup menu tutorial</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../../taurus.html">API</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../console.html">console</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="../core.html">core</a></li>
<li class="toctree-l4"><a class="reference internal" href="../qt.html">qt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../test.html">test</a></li>
<li class="toctree-l4"><a class="reference internal" href="../web.html">web</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../taurus_AllClasses.html">All Classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples.html">Examples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../other_versions.html">Docs for other Taurus versions</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../../index.html">taurus</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../../../../docs.html">Taurus 3.12 documentation</a> &raquo;</li>
      
          <li><a href="../../../index.html">Developer&#8217;s Guide</a> &raquo;</li>
      
          <li><a href="../../taurus.html"><code class="docutils literal"><span class="pre">taurus</span></code></a> &raquo;</li>
      
          <li><a href="../core.html"><code class="docutils literal"><span class="pre">taurus.core</span></code></a> &raquo;</li>
      
    <li><code class="docutils literal"><span class="pre">taurus.core.evaluation</span></code></li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../../_sources/devel/api/taurus/core/evaluation.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-taurus.core.evaluation">
<span id="taurus-core-evaluation"></span><h1><a class="reference internal" href="#module-taurus.core.evaluation" title="taurus.core.evaluation"><code class="xref py py-mod docutils literal"><span class="pre">taurus.core.evaluation</span></code></a><a class="headerlink" href="#module-taurus.core.evaluation" title="Permalink to this headline">Â¶</a></h1>
<p>Evaluation extension for taurus core model.</p>
<p>The evaluation extension is a special extension that provides evaluation
objects. The official scheme name is &#8216;eval&#8217;, but &#8216;evaluation&#8217; can be used as a synonym.</p>
<p>The main usage for this extension is to provide a way of performing mathematical
evaluations with data from other sources.</p>
<p>The Evaluation Factory (<a class="reference internal" href="evaluation/_EvaluationFactory.html#taurus.core.evaluation.EvaluationFactory" title="taurus.core.evaluation.EvaluationFactory"><code class="xref py py-class docutils literal"><span class="pre">EvaluationFactory</span></code></a>) uses the following object naming for referring to attributes (<a class="reference internal" href="evaluation/_EvaluationAttribute.html#taurus.core.evaluation.EvaluationAttribute" title="taurus.core.evaluation.EvaluationAttribute"><code class="xref py py-class docutils literal"><span class="pre">EvaluationAttribute</span></code></a>):</p>
<blockquote>
<div><p><cite>eval://[db=&lt;databasename&gt;][dev=&lt;devicename&gt;;]&lt;math_expression&gt;[?&lt;symbols&gt;][#&lt;fragment&gt;]</cite></p>
<p>or the following for referring to evaluation devices (<a class="reference internal" href="evaluation/_EvaluationDevice.html#taurus.core.evaluation.EvaluationDevice" title="taurus.core.evaluation.EvaluationDevice"><code class="xref py py-class docutils literal"><span class="pre">EvaluationDevice</span></code></a>):</p>
<p><cite>eval://[db=&lt;databasename&gt;]dev=&lt;devicename&gt;[?&lt;symbols&gt;]</cite></p>
<p>or the following for referring to an evaluation database (<a class="reference internal" href="evaluation/_EvaluationDatabase.html#taurus.core.evaluation.EvaluationDatabase" title="taurus.core.evaluation.EvaluationDatabase"><code class="xref py py-class docutils literal"><span class="pre">EvaluationDatabase</span></code></a>):</p>
<p><cite>eval://db=&lt;databasename&gt;</cite></p>
<p>or, finally, the following for referring to an attribute configuration (<a class="reference internal" href="evaluation/_EvaluationConfiguration.html#taurus.core.evaluation.EvaluationConfiguration" title="taurus.core.evaluation.EvaluationConfiguration"><code class="xref py py-class docutils literal"><span class="pre">EvaluationConfiguration</span></code></a>) item:</p>
<p><cite>eval://[db=&lt;databasename&gt;][dev=&lt;devicename&gt;;]&lt;math_expression&gt;[?&lt;symbols&gt;]?configuration=&lt;configkey&gt;</cite></p>
<p>where:</p>
<ul>
<li><p class="first">The <cite>db=&lt;databasename&gt;;</cite> segment is optional (except when referring to an
EvaluationDatabase). If not given it defaults to <cite>db=_DefaultEvalDB;</cite>.</p>
</li>
<li><p class="first">The <cite>dev=&lt;devicename&gt;;</cite> is optional (except when referring to an
EvaluationDevice). If not given, it defaults to <cite>dev=_DefaultEvaluator;</cite>.</p>
</li>
<li><p class="first"><cite>&lt;math_expression&gt;</cite> is a mathematical expression (using python syntax)
that may have references to other taurus <strong>attributes</strong> by enclosing them
between <cite>{</cite> and <cite>}</cite>. Expressions will be evaluated by the evaluator device
to which the attribute is assigned.</p>
</li>
<li><p class="first">The evaluator device inherits from <code class="xref py py-class docutils literal"><span class="pre">SafeEvaluator</span></code> which by default 
includes a large subset of mathematical functions from the <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/index.html#module-numpy" title="(in NumPy v1.16)"><code class="xref py py-mod docutils literal"><span class="pre">numpy</span></code></a>
module.</p>
</li>
<li><p class="first"><cite>&lt;devicename&gt;</cite> is a unique identification name for the evaluator device.
This allows to use different evaluator objects which may have different
symbols available for evaluation. As an alternative approach, it is also
possible to use custom-made evaluator devices as long as they inherit from
<a class="reference internal" href="evaluation/_EvaluationDevice.html#taurus.core.evaluation.EvaluationDevice" title="taurus.core.evaluation.EvaluationDevice"><code class="xref py py-class docutils literal"><span class="pre">EvaluationDevice</span></code></a>. To use a custom-made evaluator, you should
construct the <cite>&lt;devicename&gt;</cite> as <cite>&lt;modulename&gt;.&lt;classname&gt;</cite> where:</p>
<blockquote>
<div><ul class="simple">
<li><cite>&lt;modulename&gt;</cite> is a python module name and</li>
<li><cite>&lt;classname&gt;</cite> is the name of a class in <cite>&lt;modulename&gt;</cite> that derives 
from <a class="reference internal" href="evaluation/_EvaluationDevice.html#taurus.core.evaluation.EvaluationDevice" title="taurus.core.evaluation.EvaluationDevice"><code class="xref py py-class docutils literal"><span class="pre">EvaluationDevice</span></code></a></li>
</ul>
</div></blockquote>
<p>See <code class="file docutils literal"><span class="pre">&lt;taurus&gt;/core/evaluation/dev_example.py</span></code> for an example of a
custom Evaluator</p>
</li>
<li><p class="first">The optional <cite>?&lt;symbols&gt;</cite> segment is used to provide substitution symbols. 
<cite>&lt;symbols&gt;</cite> is a semicolon-separated string of <cite>&lt;key&gt;=&lt;value&gt;</cite> strings.
Before evaluation, the <cite>&lt;math_expression&gt;</cite> string will be searched for
occurrences of <cite>&lt;key&gt;</cite> which will be replaced by the corresponding
<cite>&lt;value&gt;</cite> string. If the <cite>?&lt;symbols&gt;</cite> segment is provided in an attribute
name, the symbols affect only this attribute. If they are defined in a
device name, they will be available to all attributes of that device. If
the same <cite>&lt;key&gt;</cite> is defined both in an attribute and its device, the
<cite>value</cite> defined in the attribute is used.</p>
</li>
<li><p class="first">The optional <cite>#&lt;fragment&gt;</cite> segment is not (strictly speaking) part of the
attribute name and is not processed by the Factory. It can be used to
inform <em>the client</em> (e.g. a Taurus widget that uses this attribute as
its model) that you are interested only in a given fragment (slice) of
the value of the attribute. Note that if the client does not support this
convention, this will be silently ignored. The syntax is that of python
slices (e.g. <cite>[1:-3]</cite>) and will depend on the dimensionality and type of
the attribute value</p>
</li>
<li><p class="first"><cite>&lt;configkey&gt;</cite> is a configuration item key (e.g., <cite>label, `unit</cite>,...) used
to identify a given item from the <cite>:class:EvaluationConfiguration</cite> object</p>
</li>
</ul>
</div></blockquote>
<p>Some examples of valid evaluation models are:</p>
<blockquote>
<div><ul>
<li><p class="first">An attribute that multiplies a tango attribute by 2:</p>
<blockquote>
<div><p><cite>eval://2*{tango://a/b/c/d}</cite></p>
</div></blockquote>
</li>
<li><p class="first">An attribute that adds two tango attributes together (note we can omit the <cite>tango://</cite> part
because tango is the default scheme in taurus)</p>
<blockquote>
<div><p><cite>eval://{a/b/c/d}+{f/g/h/i}</cite></p>
</div></blockquote>
</li>
<li><p class="first">An attribute that generates an array of random values:</p>
<blockquote>
<div><p><cite>eval://rand(256)</cite></p>
</div></blockquote>
</li>
<li><p class="first">An attribute that adds noise to a tango image attribute:</p>
<blockquote>
<div><p><cite>eval://{sys/tg_test/1/short_image_ro}+10*rand(*shape({sys/tg_test/1/short_image_ro}))</cite></p>
</div></blockquote>
</li>
<li><p class="first">An attribute that uses resources to calculate the voltage from the Intensity and the Resistance:</p>
<blockquote>
<div><p><cite>eval://{res://I}*{res://R}</cite></p>
</div></blockquote>
</li>
<li><p class="first">An evaluator device named <cite>foo</cite>:</p>
<blockquote>
<div><p><cite>eval://dev=foo</cite></p>
</div></blockquote>
</li>
<li><p class="first">An evaluator device named <cite>foo</cite> to which 2 custom symbols are assigned 
(which can be used by any attribute of this device):</p>
<blockquote>
<div><p><cite>eval://dev=foo?bar={tango://a/b/c/d};blah=23</cite></p>
</div></blockquote>
</li>
<li><p class="first">An attribute that multiplies <cite>blah</cite> times <cite>bar</cite> (assuming that both <cite>blah</cite>
and <cite>bar</cite> are known to device <cite>foo</cite>):</p>
<blockquote>
<div><p><cite>eval://dev=foo;blah*bar</cite></p>
</div></blockquote>
</li>
<li><p class="first">Same as the previous 2 examples together, but all in one line (the only
difference is that the symbols defined in this example affect only to this
attribute, whereas in the example above the symbols were permanently stored
by the device and thus could be used for other attributes as well):</p>
<blockquote>
<div><p><cite>eval://dev=foo;blah*bar?bar={tango://a/b/c/d};blah=23</cite></p>
</div></blockquote>
</li>
</ul>
</div></blockquote>
<p class="rubric">Classes</p>
<div class="toctree-wrapper compound">
</div>
<table class="hlist"><tr><td><ul class="simple">
<li><a class="reference internal" href="evaluation/_EvaluationAttribute.html#taurus.core.evaluation.EvaluationAttribute" title="taurus.core.evaluation.EvaluationAttribute"><code class="xref py py-class docutils literal"><span class="pre">EvaluationAttribute</span></code></a></li>
<li><a class="reference internal" href="evaluation/_EvaluationAttributeNameValidator.html#taurus.core.evaluation.EvaluationAttributeNameValidator" title="taurus.core.evaluation.EvaluationAttributeNameValidator"><code class="xref py py-class docutils literal"><span class="pre">EvaluationAttributeNameValidator</span></code></a></li>
<li><a class="reference internal" href="evaluation/_EvaluationConfiguration.html#taurus.core.evaluation.EvaluationConfiguration" title="taurus.core.evaluation.EvaluationConfiguration"><code class="xref py py-class docutils literal"><span class="pre">EvaluationConfiguration</span></code></a></li>
<li><a class="reference internal" href="evaluation/_EvaluationConfigurationNameValidator.html#taurus.core.evaluation.EvaluationConfigurationNameValidator" title="taurus.core.evaluation.EvaluationConfigurationNameValidator"><code class="xref py py-class docutils literal"><span class="pre">EvaluationConfigurationNameValidator</span></code></a></li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="evaluation/_EvaluationDatabase.html#taurus.core.evaluation.EvaluationDatabase" title="taurus.core.evaluation.EvaluationDatabase"><code class="xref py py-class docutils literal"><span class="pre">EvaluationDatabase</span></code></a></li>
<li><a class="reference internal" href="evaluation/_EvaluationDevice.html#taurus.core.evaluation.EvaluationDevice" title="taurus.core.evaluation.EvaluationDevice"><code class="xref py py-class docutils literal"><span class="pre">EvaluationDevice</span></code></a></li>
<li><a class="reference internal" href="evaluation/_EvaluationDeviceNameValidator.html#taurus.core.evaluation.EvaluationDeviceNameValidator" title="taurus.core.evaluation.EvaluationDeviceNameValidator"><code class="xref py py-class docutils literal"><span class="pre">EvaluationDeviceNameValidator</span></code></a></li>
<li><a class="reference internal" href="evaluation/_EvaluationFactory.html#taurus.core.evaluation.EvaluationFactory" title="taurus.core.evaluation.EvaluationFactory"><code class="xref py py-class docutils literal"><span class="pre">EvaluationFactory</span></code></a></li>
</ul>
</td></tr></table>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="evaluation/_EvaluationAttribute.html" class="btn btn-neutral float-right" title="EvaluationAttribute" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="epics/_EpicsFactory.html" class="btn btn-neutral" title="EpicsFactory" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Except where otherwise noted, content on this site is
licensed under a Creative Commons Attribution 3.0 License.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../../',
            VERSION:'3.12.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>